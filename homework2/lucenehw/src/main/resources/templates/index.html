<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucene Homework</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body class="bg-light d-flex flex-column align-items-center">

    <!-- Container per la descrizione senza bg-primary -->
    <div id="descriptionContainer" class="container-fluid py-5 text-center rounded mb-4 shadow">
        <h1 id="mainTitle" class="display-4 fw-bold mb-2">Welcome to Colour's Search Engine</h1>
        <p class="lead">The Best You’ve Ever Seen!</p>
        <p class="lead">Be careful you might became blind looking how beautiful is!</p>
    </div>

    <!-- Form centrato in card -->
    <div class="container d-flex justify-content-center mb-4">
        <div class="card p-4 shadow-lg" style="max-width: 500px;">
            <h3 id="headingText" class="text-center mb-4" style="color: red;">Inserisci una stringa</h3>
            <form id="searchForm" onsubmit="performSearch(event)">
                <div class="mb-3">
                    <input type="text" class="form-control" id="inputString" name="inputString" placeholder="Type your search here..." required>
                </div>

                <!-- Color Picker -->
                <div class="mb-3 text-center">
                    <label for="colorPicker" class="form-label">Choose your color!</label>
                    <input type="color" id="colorPicker" class="form-control form-control-color mx-auto" value="#563d7c" title="Choose your color">
                </div>

                <button type="submit" id="submitButton" class="btn w-100">Invia</button>
            </form>
        </div>
    </div>

    <!-- Container per i risultati della ricerca -->
    <div class="container mt-4">
        <div id="resultsContainer" class="p-4 bg-light rounded shadow">
            <h4>Risultati della ricerca:</h4>
            <ul id="resultsList" class="list-unstyled"></ul>
        </div>
    </div>

    <!-- Bootstrap JS Bundle CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoHkHr58Us9kRexIVMQAp7ntEj62Hf8zTsoG6ZhE6xga2+V" crossorigin="anonymous"></script>

    <script>
        // Funzione per calcolare il colore opposto
        function getComplementaryColor(hexColor) {
            // Rimuove il # dal colore
            hexColor = hexColor.replace('#', '');

            // Converte il colore in componenti R, G, B
            const r = parseInt(hexColor.slice(0, 2), 16);
            const g = parseInt(hexColor.slice(2, 4), 16);
            const b = parseInt(hexColor.slice(4, 6), 16);

            // Calcola il colore opposto
            const complementaryR = (255 - r).toString(16).padStart(2, '0');
            const complementaryG = (255 - g).toString(16).padStart(2, '0');
            const complementaryB = (255 - b).toString(16).padStart(2, '0');

            return `#${complementaryR}${complementaryG}${complementaryB}`;
        }

        // Listener per il cambiamento del colore
        document.getElementById('colorPicker').addEventListener('input', function(event) {
            const selectedColor = event.target.value;
            const complementaryColor = getComplementaryColor(selectedColor);

            // Cambia il colore di sfondo del container descrizione
            document.getElementById('descriptionContainer').style.backgroundColor = selectedColor;

            // Cambia il colore del testo del titolo principale e di headingText al colore opposto
            document.getElementById('headingText').style.color = selectedColor;
            document.getElementById('mainTitle').style.color = complementaryColor;

            // Cambia il colore di sfondo e del testo del pulsante
            document.getElementById('submitButton').style.backgroundColor = selectedColor;
            document.getElementById('submitButton').style.color = complementaryColor;
        });
    </script>
    <script>
        document.getElementById("searchForm").addEventListener("submit", function(event) {
            event.preventDefault();  // Previene l'invio predefinito del form
    
            // Ottieni il valore del campo di input
            const query = document.getElementById("inputString").value;
    
            // Invia la richiesta POST tramite fetch
            fetch("/search", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                body: new URLSearchParams({ inputString: query })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Errore nella risposta della rete");
                }
                return response.json();  // Converte la risposta in JSON
            })
            .then(results => {
                // Se il risultato è JSON, aggiorna i risultati nella pagina
                const resultsList = document.getElementById("resultsList");
                resultsList.innerHTML = "";  // Svuota il contenitore dei risultati
    
                results.forEach(result => {
                    const li = document.createElement("li");
                    li.textContent = result;  // Aggiunge ogni risultato come testo
                    resultsList.appendChild(li);
                });
            })
            .catch(error => console.error("Errore durante la ricerca:", error));
        });
    </script>
</body>
</html>
