<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  Batch-Instructed Gradient for Prompt Evolution: Systematic Prompt Optimization for Enhanced Text-to-Image Synthesis
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Xinrui Yang
    <br class="ltx_break"/>
    University College London
    <br class="ltx_break"/>
    xinrui.yang.20@ucl.ac.uk&amp;Zhuohan Wang
    <br class="ltx_break"/>
    University College London
    <br class="ltx_break"/>
    zhuohan.wang.23@ucl.ac.uk&amp;Anthony Hu
    <br class="ltx_break"/>
    University College London
    <br class="ltx_break"/>
    anthony.hu.19@ucl.ac.uk
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id1.id1">
   Text-to-image models have shown remarkable progress in generating high-quality images from user-provided prompts. Despite this, the quality of these images varies due to the models‚Äô sensitivity to human language nuances. With advancements in large language models (LLMs), there are new opportunities to enhance prompt design for image generation tasks. Existing research primarily focuses on optimizing prompts for direct interaction, while less attention is given to scenarios involving intermediary agents, like the Stable Diffusion model. This study proposes a Multi-Agent framework to optimize input prompts for text-to-image generation models. Central to this framework is a prompt generation mechanism that refines initial queries using dynamic instructions, which evolve through iterative performance feedback. High-quality prompts are then fed into a state-of-the-art text-to-image model. A professional prompts database serves as a benchmark to guide the instruction modifier towards generating high-caliber prompts. A scoring system evaluates the generated images, and an LLM generates new instructions based on calculated gradients. This iterative process is managed by the Upper Confidence Bound (UCB) algorithm and assessed using the Human Preference Score v2 (HPSv2). Preliminary ablation studies highlight the effectiveness of various system components and suggest areas for future improvements.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    In recent years, text-to-image models
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ramesh et¬†al.,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2021
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib9" title="">
      2022
     </a>
     ; Pryzant et¬†al.,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023
     </a>
     ; Nichol et¬†al.,
     <a class="ltx_ref" href="#bib.bib5" title="">
      2021
     </a>
     )
    </cite>
    have demonstrated the ability to generate high-quality images from user-provided prompts. However, the quality of these images can vary significantly due to the models‚Äô sensitivity to the nuances of human language. With the rapid advancement of text generation models, particularly large language models (LLMs), we now have the tools to enhance prompt design for these image generation tasks. While existing research has extensively validated the capabilities of LLMs in optimizing prompts for direct interaction
    <cite class="ltx_cite ltx_citemacro_citet">
     Yang et¬†al. (
     <a class="ltx_ref" href="#bib.bib13" title="">
      2024
     </a>
     )
    </cite>
    , less attention has been given to scenarios involving an intermediary agent, such as the Stable Diffusion model, where the prompt optimisation does not directly instruct the LLM but rather aims to improve the output of another system.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Previous studies have largely focused on optimizing "weight-accessible" language models using gradient descent
    <cite class="ltx_cite ltx_citemacro_citet">
     Pryzant et¬†al. (
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023
     </a>
     )
    </cite>
    , an approach that, while effective, is both memory-intensive and time-consuming. Conversely, the most advanced LLMs are often "weight-inaccessible," accessible only via APIs, which presents unique challenges and opportunities for prompt optimisation.
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    In this study, we propose a Multi-Agent framework to enhance the capabilities of text-to-image generation models through the optimization of input prompts. Central to our framework is a prompt generation mechanism that intelligently crafts prompts from a repository of initial simple queries. These queries are selectively refined using a set of dynamic instructions, which are systematically evolved based on iterative performance feedback, refined iteratively by dedicated agents. Our iterative loop commences with a single initial instruction, which is employed by an instruction modifier, tasked with transforming initial prompts into sophisticated queries likely to yield higher-quality images. The resulting refined prompts are fed into a state-of-the-art text-to-image model to produce visual outputs.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    To ensure the generation of high-fidelity images, we integrate a professional prompts database, an extensive collection of high-caliber prompts. This database functions as a benchmark, guiding the instruction modifier towards the quality of prompts that are proven to produce professional-grade images.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    Subsequent to the image generation, a scoring system evaluates the outputs, separating the high-quality images from the subpar ones. Inspired by the Automatic Prompt Optimization (APO) method
    <cite class="ltx_cite ltx_citemacro_citet">
     Pryzant et¬†al. (
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023
     </a>
     )
    </cite>
    , the scores derived from this system are analyzed by a gradient calculator to ascertain the factors contributing to the prompt‚Äôs success or failure. In a novel twist, we deploy another LLM to generate a variety of new instructions based on these calculated gradients. This introduces a breadth of potential modifications, ensuring that our instruction pool remains rich and versatile.
   </p>
  </div>
  <div class="ltx_para" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    The feedback obtained from this scoring and generation cycle is used to update the instruction tracks, thus refining the instruction pool in a feedback loop. Additionally, to manage the instruction list size and to balance exploitation with exploration, we employ the Upper Confidence Bound (UCB) algorithm
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kuleshov and Precup,
     <a class="ltx_ref" href="#bib.bib3" title="">
      2014
     </a>
     )
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p7">
   <p class="ltx_p" id="S1.p7.1">
    The entire process is informed by a sophisticated scoring function to accurately assess the quality of the generated images. We leverage the Human Preference Score v2 (HPSv2)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wu et¬†al.,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2023a
     </a>
     )
    </cite>
    as our scorer, which is claimed to be state-of-the-art in the field, trained on a substantial dataset of human preference data.
Through this rigorous and methodical approach to prompt optimization, our framework seeks to foster a more nuanced interaction between the linguistic understanding of LLMs and the visual creation capacity of image synthesis models. The objective is to evolve the system to a point where it can autonomously refine prompts to consistently produce images that rival professional standards, effectively narrowing the gap between human linguistic input and AI-generated visual content.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="S1.F1.g1" src="/html/2406.08713/assets/images/System_Diagram.drawio-2.png" width="449"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">
     An Overview of the our Optimizing System
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p8">
   <p class="ltx_p" id="S1.p8.1">
    Due to time constraints within the scope of this study, we conducted a preliminary ablation study focusing on several pivotal components of our system. We scrutinized the selection method, the size of the query batch, and the influence of integrating a professional prompts database to assess their individual and collective impact on the image generation process. Our findings provide initial insights into the effectiveness of these components and highlight their respective contributions to the system‚Äôs performance. In parallel, we identified potential weaknesses inherent in the current configuration, offering opportunities for future enhancements. These insights pave the way for subsequent, more in-depth research to further refine the system and maximize the quality of the AI-generated images, ensuring that our prompt optimization framework remains at the forefront of innovation in the field of text-to-image synthesis.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Literature Review
  </h2>
  <section class="ltx_subsection" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    Introduction to Current Text-to-Image Models and Prompt Optimisation
   </h3>
   <div class="ltx_para" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.1">
     Recent advancements in text-to-image models like Stable Diffusion XL
     <cite class="ltx_cite ltx_citemacro_citep">
      (Podell et¬†al.,
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023
      </a>
      )
     </cite>
     and Generative Adversarial Networks (GANs) have revolutionised the capability of generating high-quality images from textual prompts. These models often rely on nuanced prompt design to interpret human language effectively and produce relevant images. Large language models (LLMs) such as GPT and Llama are now extensively used to refine these prompts, thereby enhancing the quality of outputs. This literature review is going to discuss and compare different text-to-image generation approaches and how researchers use language models to optimize prompts and in turn improve image generation quality.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    Techniques of Prompt optimisation and Their Comparative Analysis
   </h3>
   <section class="ltx_subsubsection" id="S2.SS2.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      2.2.1
     </span>
     Reinforcement Learning and Supervised Fine-Tuning:
    </h4>
    <div class="ltx_para" id="S2.SS2.SSS1.p1">
     <p class="ltx_p" id="S2.SS2.SSS1.p1.1">
      The paper by
      <cite class="ltx_cite ltx_citemacro_citet">
       Hao et¬†al. (
       <a class="ltx_ref" href="#bib.bib1" title="">
        2024
       </a>
       )
      </cite>
      explores a hybrid approach. The approach is defined that initial prompt templates are refined using supervised learning to create a baseline which captures the intended stylistic and content-specific requirements of the images. They then utilised reinforcement learning algorithms adjust these prompts based on user feedback and model performance. The algorithm iteratively optimizes prompts to enhance both the aesthetic quality and relevance of the generated images. This method is particularly effective in scenarios where direct manipulation of model weights is not possible, offering a flexible and responsive approach to prompt optimisation. Our approach in this report has adapted this method since the weights of GPT are not accessible.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S2.SS2.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      2.2.2
     </span>
     Optimisation by Prompting (OPRO)
    </h4>
    <div class="ltx_para" id="S2.SS2.SSS2.p1">
     <p class="ltx_p" id="S2.SS2.SSS2.p1.1">
      <cite class="ltx_cite ltx_citemacro_citet">
       Yang et¬†al. (
       <a class="ltx_ref" href="#bib.bib13" title="">
        2024
       </a>
       )
      </cite>
      study provides a novel use of LLMs as dynamic optimizers. LLMs refine prompts repeatedly, taking into account feedback from previous iterations This strategy, known as Optimisation by Prompting (OPRO), improves task accuracy dramatically by leveraging LLMs‚Äô natural language interpretation and generating skills. The iterative method is assessing the efficacy of a particular prompt, modifying it based on performance indicators, and returning the modified prompt into the system. This feedback loop enables continuous enhancement and adaptability. This increases the system‚Äôs responsiveness to the intricacies of user input as well as the specialised requirements of text-to-image operations. The research demonstrates that this approach not only enhances image quality but also aligns more closely with user intentions. It in turn optimizes the interaction between human inputs and automated image generation systems.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S2.SS2.SSS3">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      2.2.3
     </span>
     LLM-based Prompt Optimisations
    </h4>
    <div class="ltx_para" id="S2.SS2.SSS3.p1">
     <p class="ltx_p" id="S2.SS2.SSS3.p1.1">
      <cite class="ltx_cite ltx_citemacro_citet">
       Ma et¬†al. (
       <a class="ltx_ref" href="#bib.bib4" title="">
        2024
       </a>
       )
      </cite>
      critically evaluate the operational issues associated with utilising LLMs to optimize prompts for text-to-image generation in their investigation of prompt optimisation with LLMs. They notice a key difficulty with LLMs‚Äô initial prompt outputs. The problem is these outputs are linguistically consistent but they are frequently ineffective in practical applications due to the stochastic nature of the model answers. To resolve these inconsistencies, the researchers propose a unique optimisation approach called "Automatic Behaviour Optimisation" (ABO). This method turns the focus away from typical prompt refinement and towards influencing the model‚Äôs interpretative and generative processes. ABO aims to give a more steady and controlled method of optimising prompts, which is especially useful in applications that need accuracy and reliability. The application of ABO has demonstrated encouraging outcomes in terms of lowering output unpredictability and raising the produced prompts‚Äô usefulness, greatly enhancing the relationship between LLMs and subsequent text-to-image tasks.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S2.SS2.SSS4">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      2.2.4
     </span>
     State-of-the-art Scoring Model
    </h4>
    <div class="ltx_para" id="S2.SS2.SSS4.p1">
     <p class="ltx_p" id="S2.SS2.SSS4.p1.1">
      The Human Preference Score version 2 (HPSv2)
      <cite class="ltx_cite ltx_citemacro_citet">
       Wu et¬†al. (
       <a class="ltx_ref" href="#bib.bib10" title="">
        2023a
       </a>
       )
      </cite>
      is a cutting-edge benchmarking tool for determining human preferences for images created via text-to-image synthesis. HPSv2 is based on the CLIP model and fine-tuned using a big human preference dataset. It outperforms earlier approaches including HPSv1
      <cite class="ltx_cite ltx_citemacro_citep">
       (Wu et¬†al.,
       <a class="ltx_ref" href="#bib.bib11" title="">
        2023b
       </a>
       )
      </cite>
      , ImageReward
      <cite class="ltx_cite ltx_citemacro_citep">
       (Xu et¬†al.,
       <a class="ltx_ref" href="#bib.bib12" title="">
        2024
       </a>
       )
      </cite>
      , and PickScore
      <cite class="ltx_cite ltx_citemacro_citep">
       (Kirstain et¬†al.,
       <a class="ltx_ref" href="#bib.bib2" title="">
        2024
       </a>
       )
      </cite>
      for predicting which pictures people would like. It stands out for its excellent accuracy, which reached 83.3% on the HPD v2 dataset. This implies that it can accurately replicate human judgement in judging synthetic pictures. The strength of HPSv2 is its strong training and ability to generalise across diverse types of pictures, making it the gold standard for evaluating image generating models.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="S2.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.3
    </span>
    Inspirations to our project
   </h3>
   <div class="ltx_para" id="S2.SS3.p1">
    <p class="ltx_p" id="S2.SS3.p1.1">
     The methodologies discussed in these papers are directly related to the research question of how to optimize prompts for text-to-image tasks using LLMs without direct weight manipulation. Each method offers a unique perspective on managing the complexities of LLMs that are weight-inaccessible, providing various strategies from adversarial learning to reinforcement learning and textual gradients. These approaches are crucial for understanding how to effectively use LLMs as Prompt Modifiers, which can refine instructions given to another system, such as a text-to-image model, to enhance output quality.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS3.p2">
    <p class="ltx_p" id="S2.SS3.p2.1">
     The reviewed literature gives a detailed overview of several techniques for optimising prompts in text-to-image generation tasks. These strategies not only improve the direct outputs of such models, but they also widen the possible uses of LLMs in digital media development. By comparing diverse techniques, this review¬†focuses on how academics are addressing the issues related with weight-inaccessible LLMs, opening the door for more advanced and accessible digital media tools.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Methodology
  </h2>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    prompt optimization for image generation
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.2">
     In this project, we optimize the instruction of Generator, guiding it refine a naive prompt says
     <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        X
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
         ùëã
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        X
       </annotation>
      </semantics>
     </math>
     to the output
     <math alttext="Y" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        Y
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
         ùëå
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">
        Y
       </annotation>
      </semantics>
     </math>
     which is an elaborate and refined prompt with detailed description in scene, color, style, quality, succeeding in generating image correlating with original object and intention but more human preference fulfilling.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     The architecture of the system is composed of three distinct language model agents operationalized via the GPT-3.5 Turbo, accessed through the OpenAI Assistant API. These agents are:
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p3">
    <ul class="ltx_itemize" id="S3.I1">
     <li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S3.I1.i1.p1">
       <p class="ltx_p" id="S3.I1.i1.p1.4">
        The
        <span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.4.1">
         Generator
        </span>
        (
        <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1">
         <semantics id="S3.I1.i1.p1.1.m1.1a">
          <mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">
           ùí¢
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b">
           <ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">
            ùí¢
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">
           \mathcal{G}
          </annotation>
         </semantics>
        </math>
        ), responsible for refine naive prompts, transforming them into detailed prompts suitable for generating high-fidelity images. The input to
        <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1">
         <semantics id="S3.I1.i1.p1.2.m2.1a">
          <mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">
           ùí¢
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b">
           <ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">
            ùí¢
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">
           \mathcal{G}
          </annotation>
         </semantics>
        </math>
        is represented by the tuple
        <math alttext="(I,X)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.2">
         <semantics id="S3.I1.i1.p1.3.m3.2a">
          <mrow id="S3.I1.i1.p1.3.m3.2.3.2" xref="S3.I1.i1.p1.3.m3.2.3.1.cmml">
           <mo id="S3.I1.i1.p1.3.m3.2.3.2.1" stretchy="false" xref="S3.I1.i1.p1.3.m3.2.3.1.cmml">
            (
           </mo>
           <mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">
            I
           </mi>
           <mo id="S3.I1.i1.p1.3.m3.2.3.2.2" xref="S3.I1.i1.p1.3.m3.2.3.1.cmml">
            ,
           </mo>
           <mi id="S3.I1.i1.p1.3.m3.2.2" xref="S3.I1.i1.p1.3.m3.2.2.cmml">
            X
           </mi>
           <mo id="S3.I1.i1.p1.3.m3.2.3.2.3" stretchy="false" xref="S3.I1.i1.p1.3.m3.2.3.1.cmml">
            )
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.2b">
           <interval closure="open" id="S3.I1.i1.p1.3.m3.2.3.1.cmml" xref="S3.I1.i1.p1.3.m3.2.3.2">
            <ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">
             ùêº
            </ci>
            <ci id="S3.I1.i1.p1.3.m3.2.2.cmml" xref="S3.I1.i1.p1.3.m3.2.2">
             ùëã
            </ci>
           </interval>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.2c">
           (I,X)
          </annotation>
         </semantics>
        </math>
        , where:
The output of
        <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.4.m4.1">
         <semantics id="S3.I1.i1.p1.4.m4.1a">
          <mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml">
           ùí¢
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b">
           <ci id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1">
            ùí¢
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">
           \mathcal{G}
          </annotation>
         </semantics>
        </math>
        is the refined prompt follows instruction.
       </p>
       <ul class="ltx_itemize" id="S3.I1.i1.I1">
        <li class="ltx_item" id="S3.I1.i1.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i1.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i1.I1.i1.p1">
          <p class="ltx_p" id="S3.I1.i1.I1.i1.p1.1">
           <math alttext="I" class="ltx_Math" display="inline" id="S3.I1.i1.I1.i1.p1.1.m1.1">
            <semantics id="S3.I1.i1.I1.i1.p1.1.m1.1a">
             <mi id="S3.I1.i1.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.I1.i1.p1.1.m1.1.1.cmml">
              I
             </mi>
             <annotation-xml encoding="MathML-Content" id="S3.I1.i1.I1.i1.p1.1.m1.1b">
              <ci id="S3.I1.i1.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.I1.i1.p1.1.m1.1.1">
               ùêº
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S3.I1.i1.I1.i1.p1.1.m1.1c">
              I
             </annotation>
            </semantics>
           </math>
           is the instruction undergoing optimization to enhance the capability of prompt generation.
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S3.I1.i1.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i1.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i1.I1.i2.p1">
          <p class="ltx_p" id="S3.I1.i1.I1.i2.p1.1">
           <math alttext="X" class="ltx_Math" display="inline" id="S3.I1.i1.I1.i2.p1.1.m1.1">
            <semantics id="S3.I1.i1.I1.i2.p1.1.m1.1a">
             <mi id="S3.I1.i1.I1.i2.p1.1.m1.1.1" xref="S3.I1.i1.I1.i2.p1.1.m1.1.1.cmml">
              X
             </mi>
             <annotation-xml encoding="MathML-Content" id="S3.I1.i1.I1.i2.p1.1.m1.1b">
              <ci id="S3.I1.i1.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i1.I1.i2.p1.1.m1.1.1">
               ùëã
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S3.I1.i1.I1.i2.p1.1.m1.1c">
              X
             </annotation>
            </semantics>
           </math>
           is the naive prompt subject to refinement.
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S3.I1.i2.p1">
       <p class="ltx_p" id="S3.I1.i2.p1.2">
        The
        <span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.2.1">
         Instruction Modifier
        </span>
        (
        <math alttext="\mathcal{I}_{\text{mod}}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1">
         <semantics id="S3.I1.i2.p1.1.m1.1a">
          <msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">
            ‚Ñê
           </mi>
           <mtext id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3a.cmml">
            mod
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b">
           <apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">
             ‚Ñê
            </ci>
            <ci id="S3.I1.i2.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">
             <mtext id="S3.I1.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I1.i2.p1.1.m1.1.1.3">
              mod
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">
           \mathcal{I}_{\text{mod}}
          </annotation>
         </semantics>
        </math>
        ), which tasked with the modification and enhancement of the extant instructions. Its purpose is to incorporate specific improvements proposed by the Gradient Calculator (
        <math alttext="\mathcal{GC}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1">
         <semantics id="S3.I1.i2.p1.2.m2.1a">
          <mrow id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">
            ùí¢
           </mi>
           <mo id="S3.I1.i2.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i2.p1.2.m2.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">
            ùíû
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b">
           <apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">
            <times id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1">
            </times>
            <ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">
             ùí¢
            </ci>
            <ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">
             ùíû
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">
           \mathcal{GC}
          </annotation>
         </semantics>
        </math>
        ) to elevate the quality and performance of generated prompts.
       </p>
      </div>
      <div class="ltx_para" id="S3.I1.i2.p2">
       <p class="ltx_p" id="S3.I1.i2.p2.2">
        The operation of
        <math alttext="\mathcal{IM}" class="ltx_Math" display="inline" id="S3.I1.i2.p2.1.m1.1">
         <semantics id="S3.I1.i2.p2.1.m1.1a">
          <mrow id="S3.I1.i2.p2.1.m1.1.1" xref="S3.I1.i2.p2.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p2.1.m1.1.1.2" xref="S3.I1.i2.p2.1.m1.1.1.2.cmml">
            ‚Ñê
           </mi>
           <mo id="S3.I1.i2.p2.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i2.p2.1.m1.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p2.1.m1.1.1.3" xref="S3.I1.i2.p2.1.m1.1.1.3.cmml">
            ‚Ñ≥
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p2.1.m1.1b">
           <apply id="S3.I1.i2.p2.1.m1.1.1.cmml" xref="S3.I1.i2.p2.1.m1.1.1">
            <times id="S3.I1.i2.p2.1.m1.1.1.1.cmml" xref="S3.I1.i2.p2.1.m1.1.1.1">
            </times>
            <ci id="S3.I1.i2.p2.1.m1.1.1.2.cmml" xref="S3.I1.i2.p2.1.m1.1.1.2">
             ‚Ñê
            </ci>
            <ci id="S3.I1.i2.p2.1.m1.1.1.3.cmml" xref="S3.I1.i2.p2.1.m1.1.1.3">
             ‚Ñ≥
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p2.1.m1.1c">
           \mathcal{IM}
          </annotation>
         </semantics>
        </math>
        is characterized by the input tuple
        <math alttext="(\text{Impr},\text{Instr})" class="ltx_Math" display="inline" id="S3.I1.i2.p2.2.m2.2">
         <semantics id="S3.I1.i2.p2.2.m2.2a">
          <mrow id="S3.I1.i2.p2.2.m2.2.3.2" xref="S3.I1.i2.p2.2.m2.2.3.1.cmml">
           <mo id="S3.I1.i2.p2.2.m2.2.3.2.1" stretchy="false" xref="S3.I1.i2.p2.2.m2.2.3.1.cmml">
            (
           </mo>
           <mtext id="S3.I1.i2.p2.2.m2.1.1" xref="S3.I1.i2.p2.2.m2.1.1a.cmml">
            Impr
           </mtext>
           <mo id="S3.I1.i2.p2.2.m2.2.3.2.2" xref="S3.I1.i2.p2.2.m2.2.3.1.cmml">
            ,
           </mo>
           <mtext id="S3.I1.i2.p2.2.m2.2.2" xref="S3.I1.i2.p2.2.m2.2.2a.cmml">
            Instr
           </mtext>
           <mo id="S3.I1.i2.p2.2.m2.2.3.2.3" stretchy="false" xref="S3.I1.i2.p2.2.m2.2.3.1.cmml">
            )
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p2.2.m2.2b">
           <interval closure="open" id="S3.I1.i2.p2.2.m2.2.3.1.cmml" xref="S3.I1.i2.p2.2.m2.2.3.2">
            <ci id="S3.I1.i2.p2.2.m2.1.1a.cmml" xref="S3.I1.i2.p2.2.m2.1.1">
             <mtext id="S3.I1.i2.p2.2.m2.1.1.cmml" xref="S3.I1.i2.p2.2.m2.1.1">
              Impr
             </mtext>
            </ci>
            <ci id="S3.I1.i2.p2.2.m2.2.2a.cmml" xref="S3.I1.i2.p2.2.m2.2.2">
             <mtext id="S3.I1.i2.p2.2.m2.2.2.cmml" xref="S3.I1.i2.p2.2.m2.2.2">
              Instr
             </mtext>
            </ci>
           </interval>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p2.2.m2.2c">
           (\text{Impr},\text{Instr})
          </annotation>
         </semantics>
        </math>
        , where:
       </p>
      </div>
      <div class="ltx_para" id="S3.I1.i2.p3">
       <ul class="ltx_itemize" id="S3.I1.i2.I1">
        <li class="ltx_item" id="S3.I1.i2.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i2.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i2.I1.i1.p1">
          <p class="ltx_p" id="S3.I1.i2.I1.i1.p1.2">
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i2.I1.i1.p1.2.1">
            Impr
           </span>
           denotes the set of suggested improvements for the instruction, as determined by
           <math alttext="\mathcal{GC}" class="ltx_Math" display="inline" id="S3.I1.i2.I1.i1.p1.2.m2.1">
            <semantics id="S3.I1.i2.I1.i1.p1.2.m2.1a">
             <mrow id="S3.I1.i2.I1.i1.p1.2.m2.1.1" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.2.cmml">
               ùí¢
              </mi>
              <mo id="S3.I1.i2.I1.i1.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.1.cmml">
               ‚Äã
              </mo>
              <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.3.cmml">
               ùíû
              </mi>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="S3.I1.i2.I1.i1.p1.2.m2.1b">
              <apply id="S3.I1.i2.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1">
               <times id="S3.I1.i2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.1">
               </times>
               <ci id="S3.I1.i2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.2">
                ùí¢
               </ci>
               <ci id="S3.I1.i2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.I1.i1.p1.2.m2.1.1.3">
                ùíû
               </ci>
              </apply>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S3.I1.i2.I1.i1.p1.2.m2.1c">
              \mathcal{GC}
             </annotation>
            </semantics>
           </math>
           .
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S3.I1.i2.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i2.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i2.I1.i2.p1">
          <p class="ltx_p" id="S3.I1.i2.I1.i2.p1.1">
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i2.I1.i2.p1.1.1">
            Instr
           </span>
           is the instruction that is currently yielding the least satisfactory results and is thereby targeted for refinement.
          </p>
         </div>
        </li>
       </ul>
      </div>
      <div class="ltx_para" id="S3.I1.i2.p4">
       <p class="ltx_p" id="S3.I1.i2.p4.5">
        Upon receiving its inputs,
        <math alttext="\mathcal{IM}" class="ltx_Math" display="inline" id="S3.I1.i2.p4.1.m1.1">
         <semantics id="S3.I1.i2.p4.1.m1.1a">
          <mrow id="S3.I1.i2.p4.1.m1.1.1" xref="S3.I1.i2.p4.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p4.1.m1.1.1.2" xref="S3.I1.i2.p4.1.m1.1.1.2.cmml">
            ‚Ñê
           </mi>
           <mo id="S3.I1.i2.p4.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i2.p4.1.m1.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p4.1.m1.1.1.3" xref="S3.I1.i2.p4.1.m1.1.1.3.cmml">
            ‚Ñ≥
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p4.1.m1.1b">
           <apply id="S3.I1.i2.p4.1.m1.1.1.cmml" xref="S3.I1.i2.p4.1.m1.1.1">
            <times id="S3.I1.i2.p4.1.m1.1.1.1.cmml" xref="S3.I1.i2.p4.1.m1.1.1.1">
            </times>
            <ci id="S3.I1.i2.p4.1.m1.1.1.2.cmml" xref="S3.I1.i2.p4.1.m1.1.1.2">
             ‚Ñê
            </ci>
            <ci id="S3.I1.i2.p4.1.m1.1.1.3.cmml" xref="S3.I1.i2.p4.1.m1.1.1.3">
             ‚Ñ≥
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p4.1.m1.1c">
           \mathcal{IM}
          </annotation>
         </semantics>
        </math>
        yields an output of
        <math alttext="n" class="ltx_Math" display="inline" id="S3.I1.i2.p4.2.m2.1">
         <semantics id="S3.I1.i2.p4.2.m2.1a">
          <mi id="S3.I1.i2.p4.2.m2.1.1" xref="S3.I1.i2.p4.2.m2.1.1.cmml">
           n
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p4.2.m2.1b">
           <ci id="S3.I1.i2.p4.2.m2.1.1.cmml" xref="S3.I1.i2.p4.2.m2.1.1">
            ùëõ
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p4.2.m2.1c">
           n
          </annotation>
         </semantics>
        </math>
        new instructions, each corresponding to
        <math alttext="n" class="ltx_Math" display="inline" id="S3.I1.i2.p4.3.m3.1">
         <semantics id="S3.I1.i2.p4.3.m3.1a">
          <mi id="S3.I1.i2.p4.3.m3.1.1" xref="S3.I1.i2.p4.3.m3.1.1.cmml">
           n
          </mi>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p4.3.m3.1b">
           <ci id="S3.I1.i2.p4.3.m3.1.1.cmml" xref="S3.I1.i2.p4.3.m3.1.1">
            ùëõ
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p4.3.m3.1c">
           n
          </annotation>
         </semantics>
        </math>
        distinct improvements. Formally, this process is defined by the mapping
        <math alttext="\mathcal{IM}:(\text{Impr},\text{Instr})\mapsto\{\text{New\_Instr}_{1},\text{New\_Instr}_{2},\ldots,\text{New\_Instr}_{n}\}" class="ltx_Math" display="inline" id="S3.I1.i2.p4.4.m4.6">
         <semantics id="S3.I1.i2.p4.4.m4.6a">
          <mrow id="S3.I1.i2.p4.4.m4.6.6" xref="S3.I1.i2.p4.4.m4.6.6.cmml">
           <mrow id="S3.I1.i2.p4.4.m4.6.6.5" xref="S3.I1.i2.p4.4.m4.6.6.5.cmml">
            <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p4.4.m4.6.6.5.2" xref="S3.I1.i2.p4.4.m4.6.6.5.2.cmml">
             ‚Ñê
            </mi>
            <mo id="S3.I1.i2.p4.4.m4.6.6.5.1" lspace="0em" rspace="0em" xref="S3.I1.i2.p4.4.m4.6.6.5.1.cmml">
             ‚Äã
            </mo>
            <mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p4.4.m4.6.6.5.3" xref="S3.I1.i2.p4.4.m4.6.6.5.3.cmml">
             ‚Ñ≥
            </mi>
           </mrow>
           <mo id="S3.I1.i2.p4.4.m4.6.6.4" lspace="0.278em" rspace="0.278em" xref="S3.I1.i2.p4.4.m4.6.6.4.cmml">
            :
           </mo>
           <mrow id="S3.I1.i2.p4.4.m4.6.6.3" xref="S3.I1.i2.p4.4.m4.6.6.3.cmml">
            <mrow id="S3.I1.i2.p4.4.m4.6.6.3.5.2" xref="S3.I1.i2.p4.4.m4.6.6.3.5.1.cmml">
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.5.2.1" stretchy="false" xref="S3.I1.i2.p4.4.m4.6.6.3.5.1.cmml">
              (
             </mo>
             <mtext id="S3.I1.i2.p4.4.m4.1.1" xref="S3.I1.i2.p4.4.m4.1.1a.cmml">
              Impr
             </mtext>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.5.2.2" xref="S3.I1.i2.p4.4.m4.6.6.3.5.1.cmml">
              ,
             </mo>
             <mtext id="S3.I1.i2.p4.4.m4.2.2" xref="S3.I1.i2.p4.4.m4.2.2a.cmml">
              Instr
             </mtext>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.5.2.3" stretchy="false" xref="S3.I1.i2.p4.4.m4.6.6.3.5.1.cmml">
              )
             </mo>
            </mrow>
            <mo id="S3.I1.i2.p4.4.m4.6.6.3.4" stretchy="false" xref="S3.I1.i2.p4.4.m4.6.6.3.4.cmml">
             ‚Ü¶
            </mo>
            <mrow id="S3.I1.i2.p4.4.m4.6.6.3.3.3" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.3.3.4" stretchy="false" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
              {
             </mo>
             <msub id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.cmml">
              <mtext id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2a.cmml">
               New_Instr
              </mtext>
              <mn id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.3" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.3.cmml">
               1
              </mn>
             </msub>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.3.3.5" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
              ,
             </mo>
             <msub id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.cmml">
              <mtext id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2a.cmml">
               New_Instr
              </mtext>
              <mn id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.3" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.3.cmml">
               2
              </mn>
             </msub>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.3.3.6" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
              ,
             </mo>
             <mi id="S3.I1.i2.p4.4.m4.3.3" mathvariant="normal" xref="S3.I1.i2.p4.4.m4.3.3.cmml">
              ‚Ä¶
             </mi>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.3.3.7" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
              ,
             </mo>
             <msub id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.cmml">
              <mtext id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2a.cmml">
               New_Instr
              </mtext>
              <mi id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.3" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.3.cmml">
               n
              </mi>
             </msub>
             <mo id="S3.I1.i2.p4.4.m4.6.6.3.3.3.8" stretchy="false" xref="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml">
              }
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p4.4.m4.6b">
           <apply id="S3.I1.i2.p4.4.m4.6.6.cmml" xref="S3.I1.i2.p4.4.m4.6.6">
            <ci id="S3.I1.i2.p4.4.m4.6.6.4.cmml" xref="S3.I1.i2.p4.4.m4.6.6.4">
             :
            </ci>
            <apply id="S3.I1.i2.p4.4.m4.6.6.5.cmml" xref="S3.I1.i2.p4.4.m4.6.6.5">
             <times id="S3.I1.i2.p4.4.m4.6.6.5.1.cmml" xref="S3.I1.i2.p4.4.m4.6.6.5.1">
             </times>
             <ci id="S3.I1.i2.p4.4.m4.6.6.5.2.cmml" xref="S3.I1.i2.p4.4.m4.6.6.5.2">
              ‚Ñê
             </ci>
             <ci id="S3.I1.i2.p4.4.m4.6.6.5.3.cmml" xref="S3.I1.i2.p4.4.m4.6.6.5.3">
              ‚Ñ≥
             </ci>
            </apply>
            <apply id="S3.I1.i2.p4.4.m4.6.6.3.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3">
             <csymbol cd="latexml" id="S3.I1.i2.p4.4.m4.6.6.3.4.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.4">
              maps-to
             </csymbol>
             <interval closure="open" id="S3.I1.i2.p4.4.m4.6.6.3.5.1.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.5.2">
              <ci id="S3.I1.i2.p4.4.m4.1.1a.cmml" xref="S3.I1.i2.p4.4.m4.1.1">
               <mtext id="S3.I1.i2.p4.4.m4.1.1.cmml" xref="S3.I1.i2.p4.4.m4.1.1">
                Impr
               </mtext>
              </ci>
              <ci id="S3.I1.i2.p4.4.m4.2.2a.cmml" xref="S3.I1.i2.p4.4.m4.2.2">
               <mtext id="S3.I1.i2.p4.4.m4.2.2.cmml" xref="S3.I1.i2.p4.4.m4.2.2">
                Instr
               </mtext>
              </ci>
             </interval>
             <set id="S3.I1.i2.p4.4.m4.6.6.3.3.4.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3">
              <apply id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.cmml" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1">
               <csymbol cd="ambiguous" id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.1.cmml" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2a.cmml" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2">
                <mtext id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2.cmml" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.2">
                 New_Instr
                </mtext>
               </ci>
               <cn id="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.I1.i2.p4.4.m4.4.4.1.1.1.1.3">
                1
               </cn>
              </apply>
              <apply id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.cmml" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2">
               <csymbol cd="ambiguous" id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.1.cmml" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2">
                subscript
               </csymbol>
               <ci id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2a.cmml" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2">
                <mtext id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2.cmml" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.2">
                 New_Instr
                </mtext>
               </ci>
               <cn id="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.3.cmml" type="integer" xref="S3.I1.i2.p4.4.m4.5.5.2.2.2.2.3">
                2
               </cn>
              </apply>
              <ci id="S3.I1.i2.p4.4.m4.3.3.cmml" xref="S3.I1.i2.p4.4.m4.3.3">
               ‚Ä¶
              </ci>
              <apply id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3">
               <csymbol cd="ambiguous" id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.1.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3">
                subscript
               </csymbol>
               <ci id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2a.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2">
                <mtext id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.2">
                 New_Instr
                </mtext>
               </ci>
               <ci id="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.3.cmml" xref="S3.I1.i2.p4.4.m4.6.6.3.3.3.3.3">
                ùëõ
               </ci>
              </apply>
             </set>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p4.4.m4.6c">
           \mathcal{IM}:(\text{Impr},\text{Instr})\mapsto\{\text{New\_Instr}_{1},\text{New\_Instr}_{2},\ldots,\text{New\_Instr}_{n}\}
          </annotation>
         </semantics>
        </math>
        , where
        <math alttext="\{\text{New\_Instr}_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.I1.i2.p4.5.m5.1">
         <semantics id="S3.I1.i2.p4.5.m5.1a">
          <msubsup id="S3.I1.i2.p4.5.m5.1.1" xref="S3.I1.i2.p4.5.m5.1.1.cmml">
           <mrow id="S3.I1.i2.p4.5.m5.1.1.1.1.1" xref="S3.I1.i2.p4.5.m5.1.1.1.1.2.cmml">
            <mo id="S3.I1.i2.p4.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.I1.i2.p4.5.m5.1.1.1.1.2.cmml">
             {
            </mo>
            <msub id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.cmml">
             <mtext id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2a.cmml">
              New_Instr
             </mtext>
             <mi id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.3" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.3.cmml">
              i
             </mi>
            </msub>
            <mo id="S3.I1.i2.p4.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.I1.i2.p4.5.m5.1.1.1.1.2.cmml">
             }
            </mo>
           </mrow>
           <mrow id="S3.I1.i2.p4.5.m5.1.1.1.3" xref="S3.I1.i2.p4.5.m5.1.1.1.3.cmml">
            <mi id="S3.I1.i2.p4.5.m5.1.1.1.3.2" xref="S3.I1.i2.p4.5.m5.1.1.1.3.2.cmml">
             i
            </mi>
            <mo id="S3.I1.i2.p4.5.m5.1.1.1.3.1" xref="S3.I1.i2.p4.5.m5.1.1.1.3.1.cmml">
             =
            </mo>
            <mn id="S3.I1.i2.p4.5.m5.1.1.1.3.3" xref="S3.I1.i2.p4.5.m5.1.1.1.3.3.cmml">
             1
            </mn>
           </mrow>
           <mi id="S3.I1.i2.p4.5.m5.1.1.3" xref="S3.I1.i2.p4.5.m5.1.1.3.cmml">
            n
           </mi>
          </msubsup>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i2.p4.5.m5.1b">
           <apply id="S3.I1.i2.p4.5.m5.1.1.cmml" xref="S3.I1.i2.p4.5.m5.1.1">
            <csymbol cd="ambiguous" id="S3.I1.i2.p4.5.m5.1.1.2.cmml" xref="S3.I1.i2.p4.5.m5.1.1">
             superscript
            </csymbol>
            <apply id="S3.I1.i2.p4.5.m5.1.1.1.cmml" xref="S3.I1.i2.p4.5.m5.1.1">
             <csymbol cd="ambiguous" id="S3.I1.i2.p4.5.m5.1.1.1.2.cmml" xref="S3.I1.i2.p4.5.m5.1.1">
              subscript
             </csymbol>
             <set id="S3.I1.i2.p4.5.m5.1.1.1.1.2.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1">
              <apply id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2a.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2">
                <mtext id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.2">
                 New_Instr
                </mtext>
               </ci>
               <ci id="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.1.1.1.3">
                ùëñ
               </ci>
              </apply>
             </set>
             <apply id="S3.I1.i2.p4.5.m5.1.1.1.3.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.3">
              <eq id="S3.I1.i2.p4.5.m5.1.1.1.3.1.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.3.1">
              </eq>
              <ci id="S3.I1.i2.p4.5.m5.1.1.1.3.2.cmml" xref="S3.I1.i2.p4.5.m5.1.1.1.3.2">
               ùëñ
              </ci>
              <cn id="S3.I1.i2.p4.5.m5.1.1.1.3.3.cmml" type="integer" xref="S3.I1.i2.p4.5.m5.1.1.1.3.3">
               1
              </cn>
             </apply>
            </apply>
            <ci id="S3.I1.i2.p4.5.m5.1.1.3.cmml" xref="S3.I1.i2.p4.5.m5.1.1.3">
             ùëõ
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i2.p4.5.m5.1c">
           \{\text{New\_Instr}_{i}\}_{i=1}^{n}
          </annotation>
         </semantics>
        </math>
        represent the series of refined instructions.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S3.I1.i3.p1">
       <p class="ltx_p" id="S3.I1.i3.p1.2">
        The
        <span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.2.1">
         Gradient Calculator
        </span>
        (
        <math alttext="\mathcal{G}_{\text{calc}}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1">
         <semantics id="S3.I1.i3.p1.1.m1.1a">
          <msub id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">
            ùí¢
           </mi>
           <mtext id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3a.cmml">
            calc
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b">
           <apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">
            <csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">
             subscript
            </csymbol>
            <ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">
             ùí¢
            </ci>
            <ci id="S3.I1.i3.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">
             <mtext id="S3.I1.i3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I1.i3.p1.1.m1.1.1.3">
              calc
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">
           \mathcal{G}_{\text{calc}}
          </annotation>
         </semantics>
        </math>
        ), whose primary function is to deduce the incremental enhancements necessary for the Generator‚Äôs instruction set. The rationale behind
        <math alttext="\mathcal{GC}" class="ltx_Math" display="inline" id="S3.I1.i3.p1.2.m2.1">
         <semantics id="S3.I1.i3.p1.2.m2.1a">
          <mrow id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.2.m2.1.1.2" xref="S3.I1.i3.p1.2.m2.1.1.2.cmml">
            ùí¢
           </mi>
           <mo id="S3.I1.i3.p1.2.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i3.p1.2.m2.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.2.m2.1.1.3" xref="S3.I1.i3.p1.2.m2.1.1.3.cmml">
            ùíû
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b">
           <apply id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">
            <times id="S3.I1.i3.p1.2.m2.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1.1">
            </times>
            <ci id="S3.I1.i3.p1.2.m2.1.1.2.cmml" xref="S3.I1.i3.p1.2.m2.1.1.2">
             ùí¢
            </ci>
            <ci id="S3.I1.i3.p1.2.m2.1.1.3.cmml" xref="S3.I1.i3.p1.2.m2.1.1.3">
             ùíû
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">
           \mathcal{GC}
          </annotation>
         </semantics>
        </math>
        is to analyze the differential in performance between prompts yielding lower scores and those with the highest scores within a given batch, which pertains to the same object‚Äîdetailed further in the appendix.
       </p>
      </div>
      <div class="ltx_para" id="S3.I1.i3.p2">
       <p class="ltx_p" id="S3.I1.i3.p2.2">
        The input for
        <math alttext="\mathcal{GC}" class="ltx_Math" display="inline" id="S3.I1.i3.p2.1.m1.1">
         <semantics id="S3.I1.i3.p2.1.m1.1a">
          <mrow id="S3.I1.i3.p2.1.m1.1.1" xref="S3.I1.i3.p2.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p2.1.m1.1.1.2" xref="S3.I1.i3.p2.1.m1.1.1.2.cmml">
            ùí¢
           </mi>
           <mo id="S3.I1.i3.p2.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i3.p2.1.m1.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p2.1.m1.1.1.3" xref="S3.I1.i3.p2.1.m1.1.1.3.cmml">
            ùíû
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p2.1.m1.1b">
           <apply id="S3.I1.i3.p2.1.m1.1.1.cmml" xref="S3.I1.i3.p2.1.m1.1.1">
            <times id="S3.I1.i3.p2.1.m1.1.1.1.cmml" xref="S3.I1.i3.p2.1.m1.1.1.1">
            </times>
            <ci id="S3.I1.i3.p2.1.m1.1.1.2.cmml" xref="S3.I1.i3.p2.1.m1.1.1.2">
             ùí¢
            </ci>
            <ci id="S3.I1.i3.p2.1.m1.1.1.3.cmml" xref="S3.I1.i3.p2.1.m1.1.1.3">
             ùíû
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p2.1.m1.1c">
           \mathcal{GC}
          </annotation>
         </semantics>
        </math>
        is given by the triplet
        <math alttext="(\text{Instr},\text{Low\_score\_prompt},\text{High\_score\_prompt})" class="ltx_Math" display="inline" id="S3.I1.i3.p2.2.m2.3">
         <semantics id="S3.I1.i3.p2.2.m2.3a">
          <mrow id="S3.I1.i3.p2.2.m2.3.4.2" xref="S3.I1.i3.p2.2.m2.3.4.1.cmml">
           <mo id="S3.I1.i3.p2.2.m2.3.4.2.1" stretchy="false" xref="S3.I1.i3.p2.2.m2.3.4.1.cmml">
            (
           </mo>
           <mtext id="S3.I1.i3.p2.2.m2.1.1" xref="S3.I1.i3.p2.2.m2.1.1a.cmml">
            Instr
           </mtext>
           <mo id="S3.I1.i3.p2.2.m2.3.4.2.2" xref="S3.I1.i3.p2.2.m2.3.4.1.cmml">
            ,
           </mo>
           <mtext id="S3.I1.i3.p2.2.m2.2.2" xref="S3.I1.i3.p2.2.m2.2.2a.cmml">
            Low_score_prompt
           </mtext>
           <mo id="S3.I1.i3.p2.2.m2.3.4.2.3" xref="S3.I1.i3.p2.2.m2.3.4.1.cmml">
            ,
           </mo>
           <mtext id="S3.I1.i3.p2.2.m2.3.3" xref="S3.I1.i3.p2.2.m2.3.3a.cmml">
            High_score_prompt
           </mtext>
           <mo id="S3.I1.i3.p2.2.m2.3.4.2.4" stretchy="false" xref="S3.I1.i3.p2.2.m2.3.4.1.cmml">
            )
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p2.2.m2.3b">
           <vector id="S3.I1.i3.p2.2.m2.3.4.1.cmml" xref="S3.I1.i3.p2.2.m2.3.4.2">
            <ci id="S3.I1.i3.p2.2.m2.1.1a.cmml" xref="S3.I1.i3.p2.2.m2.1.1">
             <mtext id="S3.I1.i3.p2.2.m2.1.1.cmml" xref="S3.I1.i3.p2.2.m2.1.1">
              Instr
             </mtext>
            </ci>
            <ci id="S3.I1.i3.p2.2.m2.2.2a.cmml" xref="S3.I1.i3.p2.2.m2.2.2">
             <mtext id="S3.I1.i3.p2.2.m2.2.2.cmml" xref="S3.I1.i3.p2.2.m2.2.2">
              Low_score_prompt
             </mtext>
            </ci>
            <ci id="S3.I1.i3.p2.2.m2.3.3a.cmml" xref="S3.I1.i3.p2.2.m2.3.3">
             <mtext id="S3.I1.i3.p2.2.m2.3.3.cmml" xref="S3.I1.i3.p2.2.m2.3.3">
              High_score_prompt
             </mtext>
            </ci>
           </vector>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p2.2.m2.3c">
           (\text{Instr},\text{Low\_score\_prompt},\text{High\_score\_prompt})
          </annotation>
         </semantics>
        </math>
        , where:
       </p>
      </div>
      <div class="ltx_para" id="S3.I1.i3.p3">
       <ul class="ltx_itemize" id="S3.I1.i3.I1">
        <li class="ltx_item" id="S3.I1.i3.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i3.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i3.I1.i1.p1">
          <p class="ltx_p" id="S3.I1.i3.I1.i1.p1.1">
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i3.I1.i1.p1.1.1">
            Instr
           </span>
           represents the current instruction correlated with the generation of the lowest average score prompts in the instruction list.
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S3.I1.i3.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i3.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i3.I1.i2.p1">
          <p class="ltx_p" id="S3.I1.i3.I1.i2.p1.2">
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i3.I1.i2.p1.2.1">
            Low_score_prompt
           </span>
           is the set of prompts that, under the governance of
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i3.I1.i2.p1.2.2">
            Instr
           </span>
           , have resulted in the lowest average scores.
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S3.I1.i3.I1.i3" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S3.I1.i3.I1.i3.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S3.I1.i3.I1.i3.p1">
          <p class="ltx_p" id="S3.I1.i3.I1.i3.p1.1">
           <span class="ltx_text ltx_markedasmath" id="S3.I1.i3.I1.i3.p1.1.1">
            High_score_prompt
           </span>
           signifies the prompt evaluated as most human-preferred image in the prompts pool.
          </p>
         </div>
        </li>
       </ul>
      </div>
      <div class="ltx_para" id="S3.I1.i3.p4">
       <p class="ltx_p" id="S3.I1.i3.p4.1">
        The output of
        <math alttext="\mathcal{GC}" class="ltx_Math" display="inline" id="S3.I1.i3.p4.1.m1.1">
         <semantics id="S3.I1.i3.p4.1.m1.1a">
          <mrow id="S3.I1.i3.p4.1.m1.1.1" xref="S3.I1.i3.p4.1.m1.1.1.cmml">
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p4.1.m1.1.1.2" xref="S3.I1.i3.p4.1.m1.1.1.2.cmml">
            ùí¢
           </mi>
           <mo id="S3.I1.i3.p4.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S3.I1.i3.p4.1.m1.1.1.1.cmml">
            ‚Äã
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p4.1.m1.1.1.3" xref="S3.I1.i3.p4.1.m1.1.1.3.cmml">
            ùíû
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i3.p4.1.m1.1b">
           <apply id="S3.I1.i3.p4.1.m1.1.1.cmml" xref="S3.I1.i3.p4.1.m1.1.1">
            <times id="S3.I1.i3.p4.1.m1.1.1.1.cmml" xref="S3.I1.i3.p4.1.m1.1.1.1">
            </times>
            <ci id="S3.I1.i3.p4.1.m1.1.1.2.cmml" xref="S3.I1.i3.p4.1.m1.1.1.2">
             ùí¢
            </ci>
            <ci id="S3.I1.i3.p4.1.m1.1.1.3.cmml" xref="S3.I1.i3.p4.1.m1.1.1.3">
             ùíû
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i3.p4.1.m1.1c">
           \mathcal{GC}
          </annotation>
         </semantics>
        </math>
        is a series of suggestions intended to refine the instruction, analogous to a gradient utilized in the iterative generation of new instructions.
       </p>
      </div>
     </li>
    </ul>
   </div>
   <div class="ltx_para" id="S3.SS1.p4">
    <p class="ltx_p" id="S3.SS1.p4.6">
     Complementing these agents is HPS v2, a text-to-image evaluation model that gauges the affinity of generated images to human preferences. The model, symbolized by
     <math alttext="\mathcal{H}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1">
      <semantics id="S3.SS1.p4.1.m1.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">
        ‚Ñã
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b">
        <ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">
         ‚Ñã
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">
        \mathcal{H}
       </annotation>
      </semantics>
     </math>
     , assigns scores to images crafted from diversified refined prompts, all stemming from the identical naive prompt
     <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1">
      <semantics id="S3.SS1.p4.2.m2.1a">
       <mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">
        X
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b">
        <ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">
         ùëã
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">
        X
       </annotation>
      </semantics>
     </math>
     . The mathematical representation of the scoring function is given by
     <math alttext="S:\mathcal{H}\times\mathcal{P}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1">
      <semantics id="S3.SS1.p4.3.m3.1a">
       <mrow id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">
        <mi id="S3.SS1.p4.3.m3.1.1.2" xref="S3.SS1.p4.3.m3.1.1.2.cmml">
         S
        </mi>
        <mo id="S3.SS1.p4.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p4.3.m3.1.1.1.cmml">
         :
        </mo>
        <mrow id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml">
         <mrow id="S3.SS1.p4.3.m3.1.1.3.2" xref="S3.SS1.p4.3.m3.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.3.m3.1.1.3.2.2" xref="S3.SS1.p4.3.m3.1.1.3.2.2.cmml">
           ‚Ñã
          </mi>
          <mo id="S3.SS1.p4.3.m3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.3.m3.1.1.3.2.1.cmml">
           √ó
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.3.m3.1.1.3.2.3" xref="S3.SS1.p4.3.m3.1.1.3.2.3.cmml">
           ùí´
          </mi>
         </mrow>
         <mo id="S3.SS1.p4.3.m3.1.1.3.1" stretchy="false" xref="S3.SS1.p4.3.m3.1.1.3.1.cmml">
          ‚Üí
         </mo>
         <mi id="S3.SS1.p4.3.m3.1.1.3.3" xref="S3.SS1.p4.3.m3.1.1.3.3.cmml">
          ‚Ñù
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b">
        <apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">
         <ci id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1">
          :
         </ci>
         <ci id="S3.SS1.p4.3.m3.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.2">
          ùëÜ
         </ci>
         <apply id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3">
          <ci id="S3.SS1.p4.3.m3.1.1.3.1.cmml" xref="S3.SS1.p4.3.m3.1.1.3.1">
           ‚Üí
          </ci>
          <apply id="S3.SS1.p4.3.m3.1.1.3.2.cmml" xref="S3.SS1.p4.3.m3.1.1.3.2">
           <times id="S3.SS1.p4.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p4.3.m3.1.1.3.2.1">
           </times>
           <ci id="S3.SS1.p4.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p4.3.m3.1.1.3.2.2">
            ‚Ñã
           </ci>
           <ci id="S3.SS1.p4.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3.2.3">
            ùí´
           </ci>
          </apply>
          <ci id="S3.SS1.p4.3.m3.1.1.3.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3.3">
           ‚Ñù
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">
        S:\mathcal{H}\times\mathcal{P}\rightarrow\mathbb{R}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1">
      <semantics id="S3.SS1.p4.4.m4.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">
        ùí´
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b">
        <ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">
         ùí´
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">
        \mathcal{P}
       </annotation>
      </semantics>
     </math>
     represents the set of prompts, and
     <math alttext="\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1">
      <semantics id="S3.SS1.p4.5.m5.1a">
       <mi id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">
        ‚Ñù
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b">
        <ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">
         ‚Ñù
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">
        \mathbb{R}
       </annotation>
      </semantics>
     </math>
     denotes the real number scoring domain. Feedback from
     <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m6.1">
      <semantics id="S3.SS1.p4.6.m6.1a">
       <mi id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml">
        S
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b">
        <ci id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1">
         ùëÜ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">
        S
       </annotation>
      </semantics>
     </math>
     informs subsequent refinements, ensuring adherence to a stringent criterion of aesthetic and pertinence in the generated images.
    </p>
   </div>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.2.1.1">
       Algorithm 1
      </span>
     </span>
     Algorithm of Generator prompt optimisation
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.3">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l1.2">
       Input:
      </span>
      <math alttext="G(\text{Instr}_{i},x_{i}),GC(\text{Instr}_{i},\text{low}_{s}\text{Prompt}_{i},\text{High}_{s}\text{Prompt}_{i})," class="ltx_Math" display="inline" id="alg1.l1.m1.1">
       <semantics id="alg1.l1.m1.1a">
        <mrow id="alg1.l1.m1.1.1.1">
         <mrow id="alg1.l1.m1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.3.cmml">
          <mrow id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">
           <mi id="alg1.l1.m1.1.1.1.1.1.1.4" xref="alg1.l1.m1.1.1.1.1.1.1.4.cmml">
            G
           </mi>
           <mo id="alg1.l1.m1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.1.1.1.1.3.cmml">
            ‚Äã
           </mo>
           <mrow id="alg1.l1.m1.1.1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.3.cmml">
            <mo id="alg1.l1.m1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.1.1.2.3.cmml">
             (
            </mo>
            <msub id="alg1.l1.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.cmml">
             <mtext id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2a.cmml">
              Instr
             </mtext>
             <mi id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.3.cmml">
              i
             </mi>
            </msub>
            <mo id="alg1.l1.m1.1.1.1.1.1.1.2.2.4" xref="alg1.l1.m1.1.1.1.1.1.1.2.3.cmml">
             ,
            </mo>
            <msub id="alg1.l1.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2.cmml">
             <mi id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2.2.cmml">
              x
             </mi>
             <mi id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2.3.cmml">
              i
             </mi>
            </msub>
            <mo id="alg1.l1.m1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l1.m1.1.1.1.1.1.1.2.3.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="alg1.l1.m1.1.1.1.1.2.3" xref="alg1.l1.m1.1.1.1.1.3.cmml">
           ,
          </mo>
          <mrow id="alg1.l1.m1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.cmml">
           <mi id="alg1.l1.m1.1.1.1.1.2.2.5" xref="alg1.l1.m1.1.1.1.1.2.2.5.cmml">
            G
           </mi>
           <mo id="alg1.l1.m1.1.1.1.1.2.2.4" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.1.1.2.2.4.cmml">
            ‚Äã
           </mo>
           <mi id="alg1.l1.m1.1.1.1.1.2.2.6" xref="alg1.l1.m1.1.1.1.1.2.2.6.cmml">
            C
           </mi>
           <mo id="alg1.l1.m1.1.1.1.1.2.2.4a" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.1.1.2.2.4.cmml">
            ‚Äã
           </mo>
           <mrow id="alg1.l1.m1.1.1.1.1.2.2.3.3" xref="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml">
            <mo id="alg1.l1.m1.1.1.1.1.2.2.3.3.4" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml">
             (
            </mo>
            <msub id="alg1.l1.m1.1.1.1.1.2.2.1.1.1" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.cmml">
             <mtext id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2a.cmml">
              Instr
             </mtext>
             <mi id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.3.cmml">
              i
             </mi>
            </msub>
            <mo id="alg1.l1.m1.1.1.1.1.2.2.3.3.5" xref="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml">
             ,
            </mo>
            <mrow id="alg1.l1.m1.1.1.1.1.2.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.cmml">
             <msub id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.cmml">
              <mtext id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2a.cmml">
               low
              </mtext>
              <mi id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">
               s
              </mi>
             </msub>
             <mo id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.1" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.1.cmml">
              ‚Äã
             </mo>
             <msub id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.cmml">
              <mtext id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2a.cmml">
               Prompt
              </mtext>
              <mi id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">
               i
              </mi>
             </msub>
            </mrow>
            <mo id="alg1.l1.m1.1.1.1.1.2.2.3.3.6" xref="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml">
             ,
            </mo>
            <mrow id="alg1.l1.m1.1.1.1.1.2.2.3.3.3" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.cmml">
             <msub id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.cmml">
              <mtext id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2a.cmml">
               High
              </mtext>
              <mi id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.3.cmml">
               s
              </mi>
             </msub>
             <mo id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.1" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.1.cmml">
              ‚Äã
             </mo>
             <msub id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.cmml">
              <mtext id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2a.cmml">
               Prompt
              </mtext>
              <mi id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.3" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.3.cmml">
               i
              </mi>
             </msub>
            </mrow>
            <mo id="alg1.l1.m1.1.1.1.1.2.2.3.3.7" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <mo id="alg1.l1.m1.1.1.1.2">
          ,
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b">
         <list id="alg1.l1.m1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.2">
          <apply id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1">
           <times id="alg1.l1.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.3">
           </times>
           <ci id="alg1.l1.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.4">
            ùê∫
           </ci>
           <interval closure="open" id="alg1.l1.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2.2">
            <apply id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2">
              <mtext id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.2">
               Instr
              </mtext>
             </ci>
             <ci id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.1.3">
              ùëñ
             </ci>
            </apply>
            <apply id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2">
              subscript
             </csymbol>
             <ci id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2.2">
              ùë•
             </ci>
             <ci id="alg1.l1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2.2.2.3">
              ùëñ
             </ci>
            </apply>
           </interval>
          </apply>
          <apply id="alg1.l1.m1.1.1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2">
           <times id="alg1.l1.m1.1.1.1.1.2.2.4.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.4">
           </times>
           <ci id="alg1.l1.m1.1.1.1.1.2.2.5.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.5">
            ùê∫
           </ci>
           <ci id="alg1.l1.m1.1.1.1.1.2.2.6.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.6">
            ùê∂
           </ci>
           <vector id="alg1.l1.m1.1.1.1.1.2.2.3.4.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3">
            <apply id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2a.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2">
              <mtext id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.2">
               Instr
              </mtext>
             </ci>
             <ci id="alg1.l1.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.1.1.1.3">
              ùëñ
             </ci>
            </apply>
            <apply id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2">
             <times id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.1">
             </times>
             <apply id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2a.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2">
               <mtext id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.2">
                low
               </mtext>
              </ci>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.2.3">
               ùë†
              </ci>
             </apply>
             <apply id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3">
              <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3">
               subscript
              </csymbol>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2a.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2">
               <mtext id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.2">
                Prompt
               </mtext>
              </ci>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.2.3.3">
               ùëñ
              </ci>
             </apply>
            </apply>
            <apply id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3">
             <times id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.1">
             </times>
             <apply id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2">
              <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2">
               subscript
              </csymbol>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2a.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2">
               <mtext id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.2">
                High
               </mtext>
              </ci>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.2.3">
               ùë†
              </ci>
             </apply>
             <apply id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3">
              <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3">
               subscript
              </csymbol>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2a.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2">
               <mtext id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.2">
                Prompt
               </mtext>
              </ci>
              <ci id="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.3.3.3.3.3">
               ùëñ
              </ci>
             </apply>
            </apply>
           </vector>
          </apply>
         </list>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m1.1c">
         G(\text{Instr}_{i},x_{i}),GC(\text{Instr}_{i},\text{low}_{s}\text{Prompt}_{i},\text{High}_{s}\text{Prompt}_{i}),
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <math alttext="IM(\text{Improvement}_{i},\text{Instr}_{i}),S(\text{prompt},\text{image})" class="ltx_Math" display="inline" id="alg1.l2.m1.4">
       <semantics id="alg1.l2.m1.4a">
        <mrow id="alg1.l2.m1.4.4.2" xref="alg1.l2.m1.4.4.3.cmml">
         <mrow id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.1.cmml">
          <mi id="alg1.l2.m1.3.3.1.1.4" xref="alg1.l2.m1.3.3.1.1.4.cmml">
           I
          </mi>
          <mo id="alg1.l2.m1.3.3.1.1.3" lspace="0em" rspace="0em" xref="alg1.l2.m1.3.3.1.1.3.cmml">
           ‚Äã
          </mo>
          <mi id="alg1.l2.m1.3.3.1.1.5" xref="alg1.l2.m1.3.3.1.1.5.cmml">
           M
          </mi>
          <mo id="alg1.l2.m1.3.3.1.1.3a" lspace="0em" rspace="0em" xref="alg1.l2.m1.3.3.1.1.3.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l2.m1.3.3.1.1.2.2" xref="alg1.l2.m1.3.3.1.1.2.3.cmml">
           <mo id="alg1.l2.m1.3.3.1.1.2.2.3" stretchy="false" xref="alg1.l2.m1.3.3.1.1.2.3.cmml">
            (
           </mo>
           <msub id="alg1.l2.m1.3.3.1.1.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.1.1.cmml">
            <mtext id="alg1.l2.m1.3.3.1.1.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.1.1.2a.cmml">
             Improvement
            </mtext>
            <mi id="alg1.l2.m1.3.3.1.1.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.1.1.3.cmml">
             i
            </mi>
           </msub>
           <mo id="alg1.l2.m1.3.3.1.1.2.2.4" xref="alg1.l2.m1.3.3.1.1.2.3.cmml">
            ,
           </mo>
           <msub id="alg1.l2.m1.3.3.1.1.2.2.2" xref="alg1.l2.m1.3.3.1.1.2.2.2.cmml">
            <mtext id="alg1.l2.m1.3.3.1.1.2.2.2.2" xref="alg1.l2.m1.3.3.1.1.2.2.2.2a.cmml">
             Instr
            </mtext>
            <mi id="alg1.l2.m1.3.3.1.1.2.2.2.3" xref="alg1.l2.m1.3.3.1.1.2.2.2.3.cmml">
             i
            </mi>
           </msub>
           <mo id="alg1.l2.m1.3.3.1.1.2.2.5" stretchy="false" xref="alg1.l2.m1.3.3.1.1.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="alg1.l2.m1.4.4.2.3" xref="alg1.l2.m1.4.4.3.cmml">
          ,
         </mo>
         <mrow id="alg1.l2.m1.4.4.2.2" xref="alg1.l2.m1.4.4.2.2.cmml">
          <mi id="alg1.l2.m1.4.4.2.2.2" xref="alg1.l2.m1.4.4.2.2.2.cmml">
           S
          </mi>
          <mo id="alg1.l2.m1.4.4.2.2.1" lspace="0em" rspace="0em" xref="alg1.l2.m1.4.4.2.2.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l2.m1.4.4.2.2.3.2" xref="alg1.l2.m1.4.4.2.2.3.1.cmml">
           <mo id="alg1.l2.m1.4.4.2.2.3.2.1" stretchy="false" xref="alg1.l2.m1.4.4.2.2.3.1.cmml">
            (
           </mo>
           <mtext id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1a.cmml">
            prompt
           </mtext>
           <mo id="alg1.l2.m1.4.4.2.2.3.2.2" xref="alg1.l2.m1.4.4.2.2.3.1.cmml">
            ,
           </mo>
           <mtext id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2a.cmml">
            image
           </mtext>
           <mo id="alg1.l2.m1.4.4.2.2.3.2.3" stretchy="false" xref="alg1.l2.m1.4.4.2.2.3.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b">
         <list id="alg1.l2.m1.4.4.3.cmml" xref="alg1.l2.m1.4.4.2">
          <apply id="alg1.l2.m1.3.3.1.1.cmml" xref="alg1.l2.m1.3.3.1.1">
           <times id="alg1.l2.m1.3.3.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.3">
           </times>
           <ci id="alg1.l2.m1.3.3.1.1.4.cmml" xref="alg1.l2.m1.3.3.1.1.4">
            ùêº
           </ci>
           <ci id="alg1.l2.m1.3.3.1.1.5.cmml" xref="alg1.l2.m1.3.3.1.1.5">
            ùëÄ
           </ci>
           <interval closure="open" id="alg1.l2.m1.3.3.1.1.2.3.cmml" xref="alg1.l2.m1.3.3.1.1.2.2">
            <apply id="alg1.l2.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l2.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l2.m1.3.3.1.1.1.1.1.2a.cmml" xref="alg1.l2.m1.3.3.1.1.1.1.1.2">
              <mtext id="alg1.l2.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.1.1.2">
               Improvement
              </mtext>
             </ci>
             <ci id="alg1.l2.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.1.1.1.3">
              ùëñ
             </ci>
            </apply>
            <apply id="alg1.l2.m1.3.3.1.1.2.2.2.cmml" xref="alg1.l2.m1.3.3.1.1.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l2.m1.3.3.1.1.2.2.2.1.cmml" xref="alg1.l2.m1.3.3.1.1.2.2.2">
              subscript
             </csymbol>
             <ci id="alg1.l2.m1.3.3.1.1.2.2.2.2a.cmml" xref="alg1.l2.m1.3.3.1.1.2.2.2.2">
              <mtext id="alg1.l2.m1.3.3.1.1.2.2.2.2.cmml" xref="alg1.l2.m1.3.3.1.1.2.2.2.2">
               Instr
              </mtext>
             </ci>
             <ci id="alg1.l2.m1.3.3.1.1.2.2.2.3.cmml" xref="alg1.l2.m1.3.3.1.1.2.2.2.3">
              ùëñ
             </ci>
            </apply>
           </interval>
          </apply>
          <apply id="alg1.l2.m1.4.4.2.2.cmml" xref="alg1.l2.m1.4.4.2.2">
           <times id="alg1.l2.m1.4.4.2.2.1.cmml" xref="alg1.l2.m1.4.4.2.2.1">
           </times>
           <ci id="alg1.l2.m1.4.4.2.2.2.cmml" xref="alg1.l2.m1.4.4.2.2.2">
            ùëÜ
           </ci>
           <interval closure="open" id="alg1.l2.m1.4.4.2.2.3.1.cmml" xref="alg1.l2.m1.4.4.2.2.3.2">
            <ci id="alg1.l2.m1.1.1a.cmml" xref="alg1.l2.m1.1.1">
             <mtext id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">
              prompt
             </mtext>
            </ci>
            <ci id="alg1.l2.m1.2.2a.cmml" xref="alg1.l2.m1.2.2">
             <mtext id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">
              image
             </mtext>
            </ci>
           </interval>
          </apply>
         </list>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.4c">
         IM(\text{Improvement}_{i},\text{Instr}_{i}),S(\text{prompt},\text{image})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l3.2">
       where
      </span>
      <math alttext="G=\text{Generator},GC=\text{Gradient Calculator}," class="ltx_Math" display="inline" id="alg1.l3.m1.1">
       <semantics id="alg1.l3.m1.1a">
        <mrow id="alg1.l3.m1.1.1.1">
         <mrow id="alg1.l3.m1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.3.cmml">
          <mrow id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">
           <mi id="alg1.l3.m1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.cmml">
            G
           </mi>
           <mo id="alg1.l3.m1.1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.1.cmml">
            =
           </mo>
           <mtext id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3a.cmml">
            Generator
           </mtext>
          </mrow>
          <mo id="alg1.l3.m1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.3a.cmml">
           ,
          </mo>
          <mrow id="alg1.l3.m1.1.1.1.1.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.cmml">
           <mrow id="alg1.l3.m1.1.1.1.1.2.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.2.cmml">
            <mi id="alg1.l3.m1.1.1.1.1.2.2.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.2.2.cmml">
             G
            </mi>
            <mo id="alg1.l3.m1.1.1.1.1.2.2.2.1" lspace="0em" rspace="0em" xref="alg1.l3.m1.1.1.1.1.2.2.2.1.cmml">
             ‚Äã
            </mo>
            <mi id="alg1.l3.m1.1.1.1.1.2.2.2.3" xref="alg1.l3.m1.1.1.1.1.2.2.2.3.cmml">
             C
            </mi>
           </mrow>
           <mo id="alg1.l3.m1.1.1.1.1.2.2.1" xref="alg1.l3.m1.1.1.1.1.2.2.1.cmml">
            =
           </mo>
           <mtext id="alg1.l3.m1.1.1.1.1.2.2.3" xref="alg1.l3.m1.1.1.1.1.2.2.3a.cmml">
            Gradient Calculator
           </mtext>
          </mrow>
         </mrow>
         <mo id="alg1.l3.m1.1.1.1.2">
          ,
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b">
         <apply id="alg1.l3.m1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.2">
          <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.1.1.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1">
           <eq id="alg1.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1">
           </eq>
           <ci id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2">
            ùê∫
           </ci>
           <ci id="alg1.l3.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">
            <mtext id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">
             Generator
            </mtext>
           </ci>
          </apply>
          <apply id="alg1.l3.m1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2">
           <eq id="alg1.l3.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.1">
           </eq>
           <apply id="alg1.l3.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2">
            <times id="alg1.l3.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2.1">
            </times>
            <ci id="alg1.l3.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2.2">
             ùê∫
            </ci>
            <ci id="alg1.l3.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2.3">
             ùê∂
            </ci>
           </apply>
           <ci id="alg1.l3.m1.1.1.1.1.2.2.3a.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.3">
            <mtext id="alg1.l3.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.3">
             Gradient Calculator
            </mtext>
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.1c">
         G=\text{Generator},GC=\text{Gradient Calculator},
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      <math alttext="IM=\text{Instruction Modifier},S=\text{Scorer}" class="ltx_Math" display="inline" id="alg1.l4.m1.2">
       <semantics id="alg1.l4.m1.2a">
        <mrow id="alg1.l4.m1.2.2.2" xref="alg1.l4.m1.2.2.3.cmml">
         <mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">
          <mrow id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.2.cmml">
           <mi id="alg1.l4.m1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.2.2.cmml">
            I
           </mi>
           <mo id="alg1.l4.m1.1.1.1.1.2.1" lspace="0em" rspace="0em" xref="alg1.l4.m1.1.1.1.1.2.1.cmml">
            ‚Äã
           </mo>
           <mi id="alg1.l4.m1.1.1.1.1.2.3" xref="alg1.l4.m1.1.1.1.1.2.3.cmml">
            M
           </mi>
          </mrow>
          <mo id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml">
           =
          </mo>
          <mtext id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.3a.cmml">
           Instruction Modifier
          </mtext>
         </mrow>
         <mo id="alg1.l4.m1.2.2.2.3" xref="alg1.l4.m1.2.2.3a.cmml">
          ,
         </mo>
         <mrow id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml">
          <mi id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.cmml">
           S
          </mi>
          <mo id="alg1.l4.m1.2.2.2.2.1" xref="alg1.l4.m1.2.2.2.2.1.cmml">
           =
          </mo>
          <mtext id="alg1.l4.m1.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.3a.cmml">
           Scorer
          </mtext>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b">
         <apply id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.2">
          <csymbol cd="ambiguous" id="alg1.l4.m1.2.2.3a.cmml" xref="alg1.l4.m1.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">
           <eq id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">
           </eq>
           <apply id="alg1.l4.m1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.2">
            <times id="alg1.l4.m1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.2.1">
            </times>
            <ci id="alg1.l4.m1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.2.2">
             ùêº
            </ci>
            <ci id="alg1.l4.m1.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.2.3">
             ùëÄ
            </ci>
           </apply>
           <ci id="alg1.l4.m1.1.1.1.1.3a.cmml" xref="alg1.l4.m1.1.1.1.1.3">
            <mtext id="alg1.l4.m1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.3">
             Instruction Modifier
            </mtext>
           </ci>
          </apply>
          <apply id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2">
           <eq id="alg1.l4.m1.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2.1">
           </eq>
           <ci id="alg1.l4.m1.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2">
            ùëÜ
           </ci>
           <ci id="alg1.l4.m1.2.2.2.2.3a.cmml" xref="alg1.l4.m1.2.2.2.2.3">
            <mtext id="alg1.l4.m1.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.3">
             Scorer
            </mtext>
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m1.2c">
         IM=\text{Instruction Modifier},S=\text{Scorer}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l5.2">
       Initialization:
      </span>
      <math alttext="\text{instruction\_list}\leftarrow[]" class="ltx_Math" display="inline" id="alg1.l5.m1.1">
       <semantics id="alg1.l5.m1.1a">
        <mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">
         <mtext id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2a.cmml">
          instruction_list
         </mtext>
         <mo id="alg1.l5.m1.1.1.1" stretchy="false" xref="alg1.l5.m1.1.1.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.cmml">
          <mo id="alg1.l5.m1.1.1.3.2.1" stretchy="false" xref="alg1.l5.m1.1.1.3.1.cmml">
           [
          </mo>
          <mo id="alg1.l5.m1.1.1.3.2.2" stretchy="false" xref="alg1.l5.m1.1.1.3.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b">
         <apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">
          <ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">
           ‚Üê
          </ci>
          <ci id="alg1.l5.m1.1.1.2a.cmml" xref="alg1.l5.m1.1.1.2">
           <mtext id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">
            instruction_list
           </mtext>
          </ci>
          <list id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.2.1">
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.1c">
         \text{instruction\_list}\leftarrow[]
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="\text{prompt\_pool}\leftarrow\{\}" class="ltx_Math" display="inline" id="alg1.l5.m2.1">
       <semantics id="alg1.l5.m2.1a">
        <mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">
         <mtext id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2a.cmml">
          prompt_pool
         </mtext>
         <mo id="alg1.l5.m2.1.1.1" stretchy="false" xref="alg1.l5.m2.1.1.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.cmml">
          <mo id="alg1.l5.m2.1.1.3.2.1" stretchy="false" xref="alg1.l5.m2.1.1.3.1.cmml">
           {
          </mo>
          <mo id="alg1.l5.m2.1.1.3.2.2" stretchy="false" xref="alg1.l5.m2.1.1.3.1.cmml">
           }
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b">
         <apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">
          <ci id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1">
           ‚Üê
          </ci>
          <ci id="alg1.l5.m2.1.1.2a.cmml" xref="alg1.l5.m2.1.1.2">
           <mtext id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">
            prompt_pool
           </mtext>
          </ci>
          <list id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3.2.1">
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m2.1c">
         \text{prompt\_pool}\leftarrow\{\}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l6.2">
       for
      </span>
      <math alttext="\text{iter}\in\text{iterations}" class="ltx_Math" display="inline" id="alg1.l6.m1.1">
       <semantics id="alg1.l6.m1.1a">
        <mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">
         <mtext id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2a.cmml">
          iter
         </mtext>
         <mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">
          ‚àà
         </mo>
         <mtext id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3a.cmml">
          iterations
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b">
         <apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">
          <in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">
          </in>
          <ci id="alg1.l6.m1.1.1.2a.cmml" xref="alg1.l6.m1.1.1.2">
           <mtext id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">
            iter
           </mtext>
          </ci>
          <ci id="alg1.l6.m1.1.1.3a.cmml" xref="alg1.l6.m1.1.1.3">
           <mtext id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">
            iterations
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.1c">
         \text{iter}\in\text{iterations}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l6.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l7.2">
       if
      </span>
      <span class="ltx_text ltx_markedasmath" id="alg1.l7.3">
       instruction_list
      </span>
      <span class="ltx_text ltx_markedasmath" id="alg1.l7.4">
       is empty
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l7.5">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      <span class="ltx_text ltx_markedasmath" id="alg1.l8.2">
       instruction_list.append(init_instr)
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l9.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l9.3">
       if
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      <math alttext="\text{querys}\leftarrow\text{sample}(\text{batch\_size naive prompts as querys})" class="ltx_Math" display="inline" id="alg1.l10.m1.1">
       <semantics id="alg1.l10.m1.1a">
        <mrow id="alg1.l10.m1.1.2" xref="alg1.l10.m1.1.2.cmml">
         <mtext id="alg1.l10.m1.1.2.2" xref="alg1.l10.m1.1.2.2a.cmml">
          querys
         </mtext>
         <mo id="alg1.l10.m1.1.2.1" stretchy="false" xref="alg1.l10.m1.1.2.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l10.m1.1.2.3" xref="alg1.l10.m1.1.2.3.cmml">
          <mtext id="alg1.l10.m1.1.2.3.2" xref="alg1.l10.m1.1.2.3.2a.cmml">
           sample
          </mtext>
          <mo id="alg1.l10.m1.1.2.3.1" lspace="0em" rspace="0em" xref="alg1.l10.m1.1.2.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l10.m1.1.2.3.3.2" xref="alg1.l10.m1.1.1a.cmml">
           <mo id="alg1.l10.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l10.m1.1.1a.cmml">
            (
           </mo>
           <mtext id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">
            batch_size naive prompts as querys
           </mtext>
           <mo id="alg1.l10.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l10.m1.1.1a.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b">
         <apply id="alg1.l10.m1.1.2.cmml" xref="alg1.l10.m1.1.2">
          <ci id="alg1.l10.m1.1.2.1.cmml" xref="alg1.l10.m1.1.2.1">
           ‚Üê
          </ci>
          <ci id="alg1.l10.m1.1.2.2a.cmml" xref="alg1.l10.m1.1.2.2">
           <mtext id="alg1.l10.m1.1.2.2.cmml" xref="alg1.l10.m1.1.2.2">
            querys
           </mtext>
          </ci>
          <apply id="alg1.l10.m1.1.2.3.cmml" xref="alg1.l10.m1.1.2.3">
           <times id="alg1.l10.m1.1.2.3.1.cmml" xref="alg1.l10.m1.1.2.3.1">
           </times>
           <ci id="alg1.l10.m1.1.2.3.2a.cmml" xref="alg1.l10.m1.1.2.3.2">
            <mtext id="alg1.l10.m1.1.2.3.2.cmml" xref="alg1.l10.m1.1.2.3.2">
             sample
            </mtext>
           </ci>
           <ci id="alg1.l10.m1.1.1a.cmml" xref="alg1.l10.m1.1.2.3.3.2">
            <mtext id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">
             batch_size naive prompts as querys
            </mtext>
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l10.m1.1c">
         \text{querys}\leftarrow\text{sample}(\text{batch\_size naive prompts as querys})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l11.2.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l11.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l11.1.m1.1">
        <semantics id="alg1.l11.1.m1.1a">
         <mo id="alg1.l11.1.m1.1.1" xref="alg1.l11.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l11.1.m1.1b">
          <ci id="alg1.l11.1.m1.1.1.cmml" xref="alg1.l11.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l11.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       generate prompts based on existing instruction
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">
        12:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.2">
       for
      </span>
      <math alttext="\text{instruction}\in\text{instruction\_list}" class="ltx_Math" display="inline" id="alg1.l12.m1.1">
       <semantics id="alg1.l12.m1.1a">
        <mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">
         <mtext id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2a.cmml">
          instruction
         </mtext>
         <mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">
          ‚àà
         </mo>
         <mtext id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3a.cmml">
          instruction_list
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b">
         <apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">
          <in id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">
          </in>
          <ci id="alg1.l12.m1.1.1.2a.cmml" xref="alg1.l12.m1.1.1.2">
           <mtext id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">
            instruction
           </mtext>
          </ci>
          <ci id="alg1.l12.m1.1.1.3a.cmml" xref="alg1.l12.m1.1.1.3">
           <mtext id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">
            instruction_list
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m1.1c">
         \text{instruction}\in\text{instruction\_list}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l13">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">
        13:
       </span>
      </span>
      <math alttext="\text{batch\_loss}\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l13.m1.1">
       <semantics id="alg1.l13.m1.1a">
        <mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">
         <mtext id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2a.cmml">
          batch_loss
         </mtext>
         <mo id="alg1.l13.m1.1.1.1" stretchy="false" xref="alg1.l13.m1.1.1.1.cmml">
          ‚Üê
         </mo>
         <mn id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b">
         <apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">
          <ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">
           ‚Üê
          </ci>
          <ci id="alg1.l13.m1.1.1.2a.cmml" xref="alg1.l13.m1.1.1.2">
           <mtext id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">
            batch_loss
           </mtext>
          </ci>
          <cn id="alg1.l13.m1.1.1.3.cmml" type="integer" xref="alg1.l13.m1.1.1.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m1.1c">
         \text{batch\_loss}\leftarrow 0
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l14">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">
        14:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l14.2">
       for
      </span>
      <math alttext="\text{query}\in\text{querys}" class="ltx_Math" display="inline" id="alg1.l14.m1.1">
       <semantics id="alg1.l14.m1.1a">
        <mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">
         <mtext id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2a.cmml">
          query
         </mtext>
         <mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">
          ‚àà
         </mo>
         <mtext id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3a.cmml">
          querys
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b">
         <apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">
          <in id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">
          </in>
          <ci id="alg1.l14.m1.1.1.2a.cmml" xref="alg1.l14.m1.1.1.2">
           <mtext id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">
            query
           </mtext>
          </ci>
          <ci id="alg1.l14.m1.1.1.3a.cmml" xref="alg1.l14.m1.1.1.3">
           <mtext id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">
            querys
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m1.1c">
         \text{query}\in\text{querys}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l14.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l15">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">
        15:
       </span>
      </span>
      <math alttext="\text{generated\_prompt}\leftarrow G.\text{output}(\text{instruction},\text{query})" class="ltx_Math" display="inline" id="alg1.l15.m1.4">
       <semantics id="alg1.l15.m1.4a">
        <mrow id="alg1.l15.m1.4.4.2" xref="alg1.l15.m1.4.4.3.cmml">
         <mrow id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">
          <mtext id="alg1.l15.m1.3.3.1.1.2" xref="alg1.l15.m1.3.3.1.1.2a.cmml">
           generated_prompt
          </mtext>
          <mo id="alg1.l15.m1.3.3.1.1.1" stretchy="false" xref="alg1.l15.m1.3.3.1.1.1.cmml">
           ‚Üê
          </mo>
          <mi id="alg1.l15.m1.3.3.1.1.3" xref="alg1.l15.m1.3.3.1.1.3.cmml">
           G
          </mi>
         </mrow>
         <mo id="alg1.l15.m1.4.4.2.3" lspace="0em" rspace="0.167em" xref="alg1.l15.m1.4.4.3a.cmml">
          .
         </mo>
         <mrow id="alg1.l15.m1.4.4.2.2" xref="alg1.l15.m1.4.4.2.2.cmml">
          <mtext id="alg1.l15.m1.4.4.2.2.2" xref="alg1.l15.m1.4.4.2.2.2a.cmml">
           output
          </mtext>
          <mo id="alg1.l15.m1.4.4.2.2.1" lspace="0em" rspace="0em" xref="alg1.l15.m1.4.4.2.2.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l15.m1.4.4.2.2.3.2" xref="alg1.l15.m1.4.4.2.2.3.1.cmml">
           <mo id="alg1.l15.m1.4.4.2.2.3.2.1" stretchy="false" xref="alg1.l15.m1.4.4.2.2.3.1.cmml">
            (
           </mo>
           <mtext id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1a.cmml">
            instruction
           </mtext>
           <mo id="alg1.l15.m1.4.4.2.2.3.2.2" xref="alg1.l15.m1.4.4.2.2.3.1.cmml">
            ,
           </mo>
           <mtext id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2a.cmml">
            query
           </mtext>
           <mo id="alg1.l15.m1.4.4.2.2.3.2.3" stretchy="false" xref="alg1.l15.m1.4.4.2.2.3.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m1.4b">
         <apply id="alg1.l15.m1.4.4.3.cmml" xref="alg1.l15.m1.4.4.2">
          <csymbol cd="ambiguous" id="alg1.l15.m1.4.4.3a.cmml" xref="alg1.l15.m1.4.4.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">
           <ci id="alg1.l15.m1.3.3.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1">
            ‚Üê
           </ci>
           <ci id="alg1.l15.m1.3.3.1.1.2a.cmml" xref="alg1.l15.m1.3.3.1.1.2">
            <mtext id="alg1.l15.m1.3.3.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.2">
             generated_prompt
            </mtext>
           </ci>
           <ci id="alg1.l15.m1.3.3.1.1.3.cmml" xref="alg1.l15.m1.3.3.1.1.3">
            ùê∫
           </ci>
          </apply>
          <apply id="alg1.l15.m1.4.4.2.2.cmml" xref="alg1.l15.m1.4.4.2.2">
           <times id="alg1.l15.m1.4.4.2.2.1.cmml" xref="alg1.l15.m1.4.4.2.2.1">
           </times>
           <ci id="alg1.l15.m1.4.4.2.2.2a.cmml" xref="alg1.l15.m1.4.4.2.2.2">
            <mtext id="alg1.l15.m1.4.4.2.2.2.cmml" xref="alg1.l15.m1.4.4.2.2.2">
             output
            </mtext>
           </ci>
           <interval closure="open" id="alg1.l15.m1.4.4.2.2.3.1.cmml" xref="alg1.l15.m1.4.4.2.2.3.2">
            <ci id="alg1.l15.m1.1.1a.cmml" xref="alg1.l15.m1.1.1">
             <mtext id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">
              instruction
             </mtext>
            </ci>
            <ci id="alg1.l15.m1.2.2a.cmml" xref="alg1.l15.m1.2.2">
             <mtext id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2">
              query
             </mtext>
            </ci>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m1.4c">
         \text{generated\_prompt}\leftarrow G.\text{output}(\text{instruction},\text{query})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l16">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l16.2.1.1" style="font-size:80%;">
        16:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l16.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l16.1.m1.1">
        <semantics id="alg1.l16.1.m1.1a">
         <mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b">
          <ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       add generated prompt to prompt pool
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l17">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">
        17:
       </span>
      </span>
      <math alttext="\text{generated\_prompt }\to\text{prompts\_pool}" class="ltx_Math" display="inline" id="alg1.l17.m1.1">
       <semantics id="alg1.l17.m1.1a">
        <mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">
         <mtext id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2a.cmml">
          generated_prompt
         </mtext>
         <mo id="alg1.l17.m1.1.1.1" stretchy="false" xref="alg1.l17.m1.1.1.1.cmml">
          ‚Üí
         </mo>
         <mtext id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3a.cmml">
          prompts_pool
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b">
         <apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">
          <ci id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1">
           ‚Üí
          </ci>
          <ci id="alg1.l17.m1.1.1.2a.cmml" xref="alg1.l17.m1.1.1.2">
           <mtext id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">
            generated_prompt
           </mtext>
          </ci>
          <ci id="alg1.l17.m1.1.1.3a.cmml" xref="alg1.l17.m1.1.1.3">
           <mtext id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">
            prompts_pool
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l17.m1.1c">
         \text{generated\_prompt }\to\text{prompts\_pool}
        </annotation>
       </semantics>
      </math>
      ;
     </div>
     <div class="ltx_listingline" id="alg1.l18">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">
        18:
       </span>
      </span>
      <math alttext="\text{loss}\leftarrow S(\text{query}\text{sdx\_turbo}(\text{generated\_prompt}))" class="ltx_Math" display="inline" id="alg1.l18.m1.2">
       <semantics id="alg1.l18.m1.2a">
        <mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml">
         <mtext id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3a.cmml">
          loss
         </mtext>
         <mo id="alg1.l18.m1.2.2.2" stretchy="false" xref="alg1.l18.m1.2.2.2.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l18.m1.2.2.1" xref="alg1.l18.m1.2.2.1.cmml">
          <mi id="alg1.l18.m1.2.2.1.3" xref="alg1.l18.m1.2.2.1.3.cmml">
           S
          </mi>
          <mo id="alg1.l18.m1.2.2.1.2" lspace="0em" rspace="0em" xref="alg1.l18.m1.2.2.1.2.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l18.m1.2.2.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.cmml">
           <mo id="alg1.l18.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l18.m1.2.2.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.l18.m1.2.2.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.cmml">
            <mrow id="alg1.l18.m1.2.2.1.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.1.2c.cmml">
             <mtext id="alg1.l18.m1.2.2.1.1.1.1.2a" xref="alg1.l18.m1.2.2.1.1.1.1.2c.cmml">
              query
             </mtext>
             <mtext id="alg1.l18.m1.2.2.1.1.1.1.2b" xref="alg1.l18.m1.2.2.1.1.1.1.2c.cmml">
              sdx_turbo
             </mtext>
            </mrow>
            <mo id="alg1.l18.m1.2.2.1.1.1.1.1" lspace="0em" rspace="0em" xref="alg1.l18.m1.2.2.1.1.1.1.1.cmml">
             ‚Äã
            </mo>
            <mrow id="alg1.l18.m1.2.2.1.1.1.1.3.2" xref="alg1.l18.m1.1.1a.cmml">
             <mo id="alg1.l18.m1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="alg1.l18.m1.1.1a.cmml">
              (
             </mo>
             <mtext id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">
              generated_prompt
             </mtext>
             <mo id="alg1.l18.m1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="alg1.l18.m1.1.1a.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="alg1.l18.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l18.m1.2.2.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b">
         <apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2">
          <ci id="alg1.l18.m1.2.2.2.cmml" xref="alg1.l18.m1.2.2.2">
           ‚Üê
          </ci>
          <ci id="alg1.l18.m1.2.2.3a.cmml" xref="alg1.l18.m1.2.2.3">
           <mtext id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3">
            loss
           </mtext>
          </ci>
          <apply id="alg1.l18.m1.2.2.1.cmml" xref="alg1.l18.m1.2.2.1">
           <times id="alg1.l18.m1.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.1.2">
           </times>
           <ci id="alg1.l18.m1.2.2.1.3.cmml" xref="alg1.l18.m1.2.2.1.3">
            ùëÜ
           </ci>
           <apply id="alg1.l18.m1.2.2.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1">
            <times id="alg1.l18.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1">
            </times>
            <ci id="alg1.l18.m1.2.2.1.1.1.1.2c.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2">
             <mrow id="alg1.l18.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2">
              <mtext id="alg1.l18.m1.2.2.1.1.1.1.2a.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2">
               query
              </mtext>
              <mtext id="alg1.l18.m1.2.2.1.1.1.1.2b.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2">
               sdx_turbo
              </mtext>
             </mrow>
            </ci>
            <ci id="alg1.l18.m1.1.1a.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.3.2">
             <mtext id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">
              generated_prompt
             </mtext>
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l18.m1.2c">
         \text{loss}\leftarrow S(\text{query}\text{sdx\_turbo}(\text{generated\_prompt}))
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l19">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">
        19:
       </span>
      </span>
      <math alttext="\text{batch\_loss}\leftarrow\text{batch\_loss}+\text{loss}" class="ltx_Math" display="inline" id="alg1.l19.m1.1">
       <semantics id="alg1.l19.m1.1a">
        <mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">
         <mtext id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2a.cmml">
          batch_loss
         </mtext>
         <mo id="alg1.l19.m1.1.1.1" stretchy="false" xref="alg1.l19.m1.1.1.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml">
          <mtext id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2a.cmml">
           batch_loss
          </mtext>
          <mo id="alg1.l19.m1.1.1.3.1" xref="alg1.l19.m1.1.1.3.1.cmml">
           +
          </mo>
          <mtext id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3a.cmml">
           loss
          </mtext>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b">
         <apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">
          <ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">
           ‚Üê
          </ci>
          <ci id="alg1.l19.m1.1.1.2a.cmml" xref="alg1.l19.m1.1.1.2">
           <mtext id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">
            batch_loss
           </mtext>
          </ci>
          <apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">
           <plus id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3.1">
           </plus>
           <ci id="alg1.l19.m1.1.1.3.2a.cmml" xref="alg1.l19.m1.1.1.3.2">
            <mtext id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2">
             batch_loss
            </mtext>
           </ci>
           <ci id="alg1.l19.m1.1.1.3.3a.cmml" xref="alg1.l19.m1.1.1.3.3">
            <mtext id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3">
             loss
            </mtext>
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l19.m1.1c">
         \text{batch\_loss}\leftarrow\text{batch\_loss}+\text{loss}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l20">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">
        20:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l20.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l20.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l21">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l21.2.1.1" style="font-size:80%;">
        21:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l21.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l21.1.m1.1">
        <semantics id="alg1.l21.1.m1.1a">
         <mo id="alg1.l21.1.m1.1.1" xref="alg1.l21.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l21.1.m1.1b">
          <ci id="alg1.l21.1.m1.1.1.cmml" xref="alg1.l21.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l21.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       add instruction and its loss to list
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l22">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">
        22:
       </span>
      </span>
      <math alttext="\text{instruction\_list}[\text{instruction}]\leftarrow(\text{Avg}(\text{batch\_loss}),\text{generated\_prompt\_list})" class="ltx_Math" display="inline" id="alg1.l22.m1.4">
       <semantics id="alg1.l22.m1.4a">
        <mrow id="alg1.l22.m1.4.4" xref="alg1.l22.m1.4.4.cmml">
         <mrow id="alg1.l22.m1.4.4.3" xref="alg1.l22.m1.4.4.3.cmml">
          <mtext id="alg1.l22.m1.4.4.3.2" xref="alg1.l22.m1.4.4.3.2a.cmml">
           instruction_list
          </mtext>
          <mo id="alg1.l22.m1.4.4.3.1" lspace="0em" rspace="0em" xref="alg1.l22.m1.4.4.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l22.m1.4.4.3.3.2" xref="alg1.l22.m1.4.4.3.3.1.cmml">
           <mo id="alg1.l22.m1.4.4.3.3.2.1" stretchy="false" xref="alg1.l22.m1.4.4.3.3.1.1.cmml">
            [
           </mo>
           <mtext id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1a.cmml">
            instruction
           </mtext>
           <mo id="alg1.l22.m1.4.4.3.3.2.2" stretchy="false" xref="alg1.l22.m1.4.4.3.3.1.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
         <mo id="alg1.l22.m1.4.4.2" stretchy="false" xref="alg1.l22.m1.4.4.2.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l22.m1.4.4.1.1" xref="alg1.l22.m1.4.4.1.2.cmml">
          <mo id="alg1.l22.m1.4.4.1.1.2" stretchy="false" xref="alg1.l22.m1.4.4.1.2.cmml">
           (
          </mo>
          <mrow id="alg1.l22.m1.4.4.1.1.1" xref="alg1.l22.m1.4.4.1.1.1.cmml">
           <mtext id="alg1.l22.m1.4.4.1.1.1.2" xref="alg1.l22.m1.4.4.1.1.1.2a.cmml">
            Avg
           </mtext>
           <mo id="alg1.l22.m1.4.4.1.1.1.1" lspace="0em" rspace="0em" xref="alg1.l22.m1.4.4.1.1.1.1.cmml">
            ‚Äã
           </mo>
           <mrow id="alg1.l22.m1.4.4.1.1.1.3.2" xref="alg1.l22.m1.2.2a.cmml">
            <mo id="alg1.l22.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="alg1.l22.m1.2.2a.cmml">
             (
            </mo>
            <mtext id="alg1.l22.m1.2.2" xref="alg1.l22.m1.2.2.cmml">
             batch_loss
            </mtext>
            <mo id="alg1.l22.m1.4.4.1.1.1.3.2.2" stretchy="false" xref="alg1.l22.m1.2.2a.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="alg1.l22.m1.4.4.1.1.3" xref="alg1.l22.m1.4.4.1.2.cmml">
           ,
          </mo>
          <mtext id="alg1.l22.m1.3.3" xref="alg1.l22.m1.3.3a.cmml">
           generated_prompt_list
          </mtext>
          <mo id="alg1.l22.m1.4.4.1.1.4" stretchy="false" xref="alg1.l22.m1.4.4.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l22.m1.4b">
         <apply id="alg1.l22.m1.4.4.cmml" xref="alg1.l22.m1.4.4">
          <ci id="alg1.l22.m1.4.4.2.cmml" xref="alg1.l22.m1.4.4.2">
           ‚Üê
          </ci>
          <apply id="alg1.l22.m1.4.4.3.cmml" xref="alg1.l22.m1.4.4.3">
           <times id="alg1.l22.m1.4.4.3.1.cmml" xref="alg1.l22.m1.4.4.3.1">
           </times>
           <ci id="alg1.l22.m1.4.4.3.2a.cmml" xref="alg1.l22.m1.4.4.3.2">
            <mtext id="alg1.l22.m1.4.4.3.2.cmml" xref="alg1.l22.m1.4.4.3.2">
             instruction_list
            </mtext>
           </ci>
           <apply id="alg1.l22.m1.4.4.3.3.1.cmml" xref="alg1.l22.m1.4.4.3.3.2">
            <csymbol cd="latexml" id="alg1.l22.m1.4.4.3.3.1.1.cmml" xref="alg1.l22.m1.4.4.3.3.2.1">
             delimited-[]
            </csymbol>
            <ci id="alg1.l22.m1.1.1a.cmml" xref="alg1.l22.m1.1.1">
             <mtext id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">
              instruction
             </mtext>
            </ci>
           </apply>
          </apply>
          <interval closure="open" id="alg1.l22.m1.4.4.1.2.cmml" xref="alg1.l22.m1.4.4.1.1">
           <apply id="alg1.l22.m1.4.4.1.1.1.cmml" xref="alg1.l22.m1.4.4.1.1.1">
            <times id="alg1.l22.m1.4.4.1.1.1.1.cmml" xref="alg1.l22.m1.4.4.1.1.1.1">
            </times>
            <ci id="alg1.l22.m1.4.4.1.1.1.2a.cmml" xref="alg1.l22.m1.4.4.1.1.1.2">
             <mtext id="alg1.l22.m1.4.4.1.1.1.2.cmml" xref="alg1.l22.m1.4.4.1.1.1.2">
              Avg
             </mtext>
            </ci>
            <ci id="alg1.l22.m1.2.2a.cmml" xref="alg1.l22.m1.4.4.1.1.1.3.2">
             <mtext id="alg1.l22.m1.2.2.cmml" xref="alg1.l22.m1.2.2">
              batch_loss
             </mtext>
            </ci>
           </apply>
           <ci id="alg1.l22.m1.3.3a.cmml" xref="alg1.l22.m1.3.3">
            <mtext id="alg1.l22.m1.3.3.cmml" xref="alg1.l22.m1.3.3">
             generated_prompt_list
            </mtext>
           </ci>
          </interval>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l22.m1.4c">
         \text{instruction\_list}[\text{instruction}]\leftarrow(\text{Avg}(\text{batch\_loss}),\text{generated\_prompt\_list})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l23">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">
        23:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l23.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l23.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l24">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">
        24:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l24.2">
       for
      </span>
      <math alttext="\text{query}\in\text{querys}" class="ltx_Math" display="inline" id="alg1.l24.m1.1">
       <semantics id="alg1.l24.m1.1a">
        <mrow id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">
         <mtext id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2a.cmml">
          query
         </mtext>
         <mo id="alg1.l24.m1.1.1.1" xref="alg1.l24.m1.1.1.1.cmml">
          ‚àà
         </mo>
         <mtext id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3a.cmml">
          querys
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b">
         <apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">
          <in id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1">
          </in>
          <ci id="alg1.l24.m1.1.1.2a.cmml" xref="alg1.l24.m1.1.1.2">
           <mtext id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">
            query
           </mtext>
          </ci>
          <ci id="alg1.l24.m1.1.1.3a.cmml" xref="alg1.l24.m1.1.1.3">
           <mtext id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3">
            querys
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l24.m1.1c">
         \text{query}\in\text{querys}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l24.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l25">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l25.2.1.1" style="font-size:80%;">
        25:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l25.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l25.1.m1.1">
        <semantics id="alg1.l25.1.m1.1a">
         <mo id="alg1.l25.1.m1.1.1" xref="alg1.l25.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l25.1.m1.1b">
          <ci id="alg1.l25.1.m1.1.1.cmml" xref="alg1.l25.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l25.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       add lexica_prompts to prompt_pool
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l26">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l26.1.1.1" style="font-size:80%;">
        26:
       </span>
      </span>
      <math alttext="\text{lexica\_prompts}\leftarrow\text{fetch\_prompts\_from\_lexica}(\text{query})" class="ltx_Math" display="inline" id="alg1.l26.m1.1">
       <semantics id="alg1.l26.m1.1a">
        <mrow id="alg1.l26.m1.1.2" xref="alg1.l26.m1.1.2.cmml">
         <mtext id="alg1.l26.m1.1.2.2" xref="alg1.l26.m1.1.2.2a.cmml">
          lexica_prompts
         </mtext>
         <mo id="alg1.l26.m1.1.2.1" stretchy="false" xref="alg1.l26.m1.1.2.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l26.m1.1.2.3" xref="alg1.l26.m1.1.2.3.cmml">
          <mtext id="alg1.l26.m1.1.2.3.2" xref="alg1.l26.m1.1.2.3.2a.cmml">
           fetch_prompts_from_lexica
          </mtext>
          <mo id="alg1.l26.m1.1.2.3.1" lspace="0em" rspace="0em" xref="alg1.l26.m1.1.2.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l26.m1.1.2.3.3.2" xref="alg1.l26.m1.1.1a.cmml">
           <mo id="alg1.l26.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l26.m1.1.1a.cmml">
            (
           </mo>
           <mtext id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml">
            query
           </mtext>
           <mo id="alg1.l26.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l26.m1.1.1a.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b">
         <apply id="alg1.l26.m1.1.2.cmml" xref="alg1.l26.m1.1.2">
          <ci id="alg1.l26.m1.1.2.1.cmml" xref="alg1.l26.m1.1.2.1">
           ‚Üê
          </ci>
          <ci id="alg1.l26.m1.1.2.2a.cmml" xref="alg1.l26.m1.1.2.2">
           <mtext id="alg1.l26.m1.1.2.2.cmml" xref="alg1.l26.m1.1.2.2">
            lexica_prompts
           </mtext>
          </ci>
          <apply id="alg1.l26.m1.1.2.3.cmml" xref="alg1.l26.m1.1.2.3">
           <times id="alg1.l26.m1.1.2.3.1.cmml" xref="alg1.l26.m1.1.2.3.1">
           </times>
           <ci id="alg1.l26.m1.1.2.3.2a.cmml" xref="alg1.l26.m1.1.2.3.2">
            <mtext id="alg1.l26.m1.1.2.3.2.cmml" xref="alg1.l26.m1.1.2.3.2">
             fetch_prompts_from_lexica
            </mtext>
           </ci>
           <ci id="alg1.l26.m1.1.1a.cmml" xref="alg1.l26.m1.1.2.3.3.2">
            <mtext id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">
             query
            </mtext>
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l26.m1.1c">
         \text{lexica\_prompts}\leftarrow\text{fetch\_prompts\_from\_lexica}(\text{query})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l27">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">
        27:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l27.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l27.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l28">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">
        28:
       </span>
      </span>
      <span class="ltx_text ltx_markedasmath" id="alg1.l28.2">
       epsilon_greedy_instr_selection()
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l29">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l29.1.1.1" style="font-size:80%;">
        29:
       </span>
      </span>
      <math alttext="\text{instr\_to\_modify}\leftarrow\text{find\_lowest\_instruction}()" class="ltx_Math" display="inline" id="alg1.l29.m1.1">
       <semantics id="alg1.l29.m1.1a">
        <mrow id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml">
         <mtext id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2a.cmml">
          instr_to_modify
         </mtext>
         <mo id="alg1.l29.m1.1.1.1" stretchy="false" xref="alg1.l29.m1.1.1.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml">
          <mtext id="alg1.l29.m1.1.1.3.2" xref="alg1.l29.m1.1.1.3.2a.cmml">
           find_lowest_instruction
          </mtext>
          <mo id="alg1.l29.m1.1.1.3.1" lspace="0em" rspace="0em" xref="alg1.l29.m1.1.1.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l29.m1.1.1.3.3.2" xref="alg1.l29.m1.1.1.3.cmml">
           <mo id="alg1.l29.m1.1.1.3.3.2.1" stretchy="false" xref="alg1.l29.m1.1.1.3.3.1.cmml">
            (
           </mo>
           <mo id="alg1.l29.m1.1.1.3.3.2.2" stretchy="false" xref="alg1.l29.m1.1.1.3.3.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b">
         <apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1">
          <ci id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1.1">
           ‚Üê
          </ci>
          <ci id="alg1.l29.m1.1.1.2a.cmml" xref="alg1.l29.m1.1.1.2">
           <mtext id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2">
            instr_to_modify
           </mtext>
          </ci>
          <apply id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3">
           <times id="alg1.l29.m1.1.1.3.1.cmml" xref="alg1.l29.m1.1.1.3.1">
           </times>
           <ci id="alg1.l29.m1.1.1.3.2a.cmml" xref="alg1.l29.m1.1.1.3.2">
            <mtext id="alg1.l29.m1.1.1.3.2.cmml" xref="alg1.l29.m1.1.1.3.2">
             find_lowest_instruction
            </mtext>
           </ci>
           <list id="alg1.l29.m1.1.1.3.3.1.cmml" xref="alg1.l29.m1.1.1.3.3.2.1">
           </list>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l29.m1.1c">
         \text{instr\_to\_modify}\leftarrow\text{find\_lowest\_instruction}()
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l30">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l30.1.1.1" style="font-size:80%;">
        30:
       </span>
      </span>
      <math alttext="\text{improvement}\leftarrow GC(\text{instr\_to\_modify},X,\text{high\_score\_prompt})" class="ltx_Math" display="inline" id="alg1.l30.m1.3">
       <semantics id="alg1.l30.m1.3a">
        <mrow id="alg1.l30.m1.3.4" xref="alg1.l30.m1.3.4.cmml">
         <mtext id="alg1.l30.m1.3.4.2" xref="alg1.l30.m1.3.4.2a.cmml">
          improvement
         </mtext>
         <mo id="alg1.l30.m1.3.4.1" stretchy="false" xref="alg1.l30.m1.3.4.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l30.m1.3.4.3" xref="alg1.l30.m1.3.4.3.cmml">
          <mi id="alg1.l30.m1.3.4.3.2" xref="alg1.l30.m1.3.4.3.2.cmml">
           G
          </mi>
          <mo id="alg1.l30.m1.3.4.3.1" lspace="0em" rspace="0em" xref="alg1.l30.m1.3.4.3.1.cmml">
           ‚Äã
          </mo>
          <mi id="alg1.l30.m1.3.4.3.3" xref="alg1.l30.m1.3.4.3.3.cmml">
           C
          </mi>
          <mo id="alg1.l30.m1.3.4.3.1a" lspace="0em" rspace="0em" xref="alg1.l30.m1.3.4.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l30.m1.3.4.3.4.2" xref="alg1.l30.m1.3.4.3.4.1.cmml">
           <mo id="alg1.l30.m1.3.4.3.4.2.1" stretchy="false" xref="alg1.l30.m1.3.4.3.4.1.cmml">
            (
           </mo>
           <mtext id="alg1.l30.m1.1.1" xref="alg1.l30.m1.1.1a.cmml">
            instr_to_modify
           </mtext>
           <mo id="alg1.l30.m1.3.4.3.4.2.2" xref="alg1.l30.m1.3.4.3.4.1.cmml">
            ,
           </mo>
           <mi id="alg1.l30.m1.2.2" xref="alg1.l30.m1.2.2.cmml">
            X
           </mi>
           <mo id="alg1.l30.m1.3.4.3.4.2.3" xref="alg1.l30.m1.3.4.3.4.1.cmml">
            ,
           </mo>
           <mtext id="alg1.l30.m1.3.3" xref="alg1.l30.m1.3.3a.cmml">
            high_score_prompt
           </mtext>
           <mo id="alg1.l30.m1.3.4.3.4.2.4" stretchy="false" xref="alg1.l30.m1.3.4.3.4.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l30.m1.3b">
         <apply id="alg1.l30.m1.3.4.cmml" xref="alg1.l30.m1.3.4">
          <ci id="alg1.l30.m1.3.4.1.cmml" xref="alg1.l30.m1.3.4.1">
           ‚Üê
          </ci>
          <ci id="alg1.l30.m1.3.4.2a.cmml" xref="alg1.l30.m1.3.4.2">
           <mtext id="alg1.l30.m1.3.4.2.cmml" xref="alg1.l30.m1.3.4.2">
            improvement
           </mtext>
          </ci>
          <apply id="alg1.l30.m1.3.4.3.cmml" xref="alg1.l30.m1.3.4.3">
           <times id="alg1.l30.m1.3.4.3.1.cmml" xref="alg1.l30.m1.3.4.3.1">
           </times>
           <ci id="alg1.l30.m1.3.4.3.2.cmml" xref="alg1.l30.m1.3.4.3.2">
            ùê∫
           </ci>
           <ci id="alg1.l30.m1.3.4.3.3.cmml" xref="alg1.l30.m1.3.4.3.3">
            ùê∂
           </ci>
           <vector id="alg1.l30.m1.3.4.3.4.1.cmml" xref="alg1.l30.m1.3.4.3.4.2">
            <ci id="alg1.l30.m1.1.1a.cmml" xref="alg1.l30.m1.1.1">
             <mtext id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1">
              instr_to_modify
             </mtext>
            </ci>
            <ci id="alg1.l30.m1.2.2.cmml" xref="alg1.l30.m1.2.2">
             ùëã
            </ci>
            <ci id="alg1.l30.m1.3.3a.cmml" xref="alg1.l30.m1.3.3">
             <mtext id="alg1.l30.m1.3.3.cmml" xref="alg1.l30.m1.3.3">
              high_score_prompt
             </mtext>
            </ci>
           </vector>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l30.m1.3c">
         \text{improvement}\leftarrow GC(\text{instr\_to\_modify},X,\text{high\_score\_prompt})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l31">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l31.2.1.1" style="font-size:80%;">
        31:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l31.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l31.1.m1.1">
        <semantics id="alg1.l31.1.m1.1a">
         <mo id="alg1.l31.1.m1.1.1" xref="alg1.l31.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l31.1.m1.1b">
          <ci id="alg1.l31.1.m1.1.1.cmml" xref="alg1.l31.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l31.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       add new_instr to instruction_list
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l32">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l32.1.1.1" style="font-size:80%;">
        32:
       </span>
      </span>
      <math alttext="\text{new\_instr}\leftarrow IM(\text{improvement},\text{instr\_to\_modify})" class="ltx_Math" display="inline" id="alg1.l32.m1.2">
       <semantics id="alg1.l32.m1.2a">
        <mrow id="alg1.l32.m1.2.3" xref="alg1.l32.m1.2.3.cmml">
         <mtext id="alg1.l32.m1.2.3.2" xref="alg1.l32.m1.2.3.2a.cmml">
          new_instr
         </mtext>
         <mo id="alg1.l32.m1.2.3.1" stretchy="false" xref="alg1.l32.m1.2.3.1.cmml">
          ‚Üê
         </mo>
         <mrow id="alg1.l32.m1.2.3.3" xref="alg1.l32.m1.2.3.3.cmml">
          <mi id="alg1.l32.m1.2.3.3.2" xref="alg1.l32.m1.2.3.3.2.cmml">
           I
          </mi>
          <mo id="alg1.l32.m1.2.3.3.1" lspace="0em" rspace="0em" xref="alg1.l32.m1.2.3.3.1.cmml">
           ‚Äã
          </mo>
          <mi id="alg1.l32.m1.2.3.3.3" xref="alg1.l32.m1.2.3.3.3.cmml">
           M
          </mi>
          <mo id="alg1.l32.m1.2.3.3.1a" lspace="0em" rspace="0em" xref="alg1.l32.m1.2.3.3.1.cmml">
           ‚Äã
          </mo>
          <mrow id="alg1.l32.m1.2.3.3.4.2" xref="alg1.l32.m1.2.3.3.4.1.cmml">
           <mo id="alg1.l32.m1.2.3.3.4.2.1" stretchy="false" xref="alg1.l32.m1.2.3.3.4.1.cmml">
            (
           </mo>
           <mtext id="alg1.l32.m1.1.1" xref="alg1.l32.m1.1.1a.cmml">
            improvement
           </mtext>
           <mo id="alg1.l32.m1.2.3.3.4.2.2" xref="alg1.l32.m1.2.3.3.4.1.cmml">
            ,
           </mo>
           <mtext id="alg1.l32.m1.2.2" xref="alg1.l32.m1.2.2a.cmml">
            instr_to_modify
           </mtext>
           <mo id="alg1.l32.m1.2.3.3.4.2.3" stretchy="false" xref="alg1.l32.m1.2.3.3.4.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l32.m1.2b">
         <apply id="alg1.l32.m1.2.3.cmml" xref="alg1.l32.m1.2.3">
          <ci id="alg1.l32.m1.2.3.1.cmml" xref="alg1.l32.m1.2.3.1">
           ‚Üê
          </ci>
          <ci id="alg1.l32.m1.2.3.2a.cmml" xref="alg1.l32.m1.2.3.2">
           <mtext id="alg1.l32.m1.2.3.2.cmml" xref="alg1.l32.m1.2.3.2">
            new_instr
           </mtext>
          </ci>
          <apply id="alg1.l32.m1.2.3.3.cmml" xref="alg1.l32.m1.2.3.3">
           <times id="alg1.l32.m1.2.3.3.1.cmml" xref="alg1.l32.m1.2.3.3.1">
           </times>
           <ci id="alg1.l32.m1.2.3.3.2.cmml" xref="alg1.l32.m1.2.3.3.2">
            ùêº
           </ci>
           <ci id="alg1.l32.m1.2.3.3.3.cmml" xref="alg1.l32.m1.2.3.3.3">
            ùëÄ
           </ci>
           <interval closure="open" id="alg1.l32.m1.2.3.3.4.1.cmml" xref="alg1.l32.m1.2.3.3.4.2">
            <ci id="alg1.l32.m1.1.1a.cmml" xref="alg1.l32.m1.1.1">
             <mtext id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1">
              improvement
             </mtext>
            </ci>
            <ci id="alg1.l32.m1.2.2a.cmml" xref="alg1.l32.m1.2.2">
             <mtext id="alg1.l32.m1.2.2.cmml" xref="alg1.l32.m1.2.2">
              instr_to_modify
             </mtext>
            </ci>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l32.m1.2c">
         \text{new\_instr}\leftarrow IM(\text{improvement},\text{instr\_to\_modify})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l33">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l33.1.1.1" style="font-size:80%;">
        33:
       </span>
      </span>
      <math alttext="\text{new\_instr}\to\text{instruction\_list}" class="ltx_Math" display="inline" id="alg1.l33.m1.1">
       <semantics id="alg1.l33.m1.1a">
        <mrow id="alg1.l33.m1.1.1" xref="alg1.l33.m1.1.1.cmml">
         <mtext id="alg1.l33.m1.1.1.2" xref="alg1.l33.m1.1.1.2a.cmml">
          new_instr
         </mtext>
         <mo id="alg1.l33.m1.1.1.1" stretchy="false" xref="alg1.l33.m1.1.1.1.cmml">
          ‚Üí
         </mo>
         <mtext id="alg1.l33.m1.1.1.3" xref="alg1.l33.m1.1.1.3a.cmml">
          instruction_list
         </mtext>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l33.m1.1b">
         <apply id="alg1.l33.m1.1.1.cmml" xref="alg1.l33.m1.1.1">
          <ci id="alg1.l33.m1.1.1.1.cmml" xref="alg1.l33.m1.1.1.1">
           ‚Üí
          </ci>
          <ci id="alg1.l33.m1.1.1.2a.cmml" xref="alg1.l33.m1.1.1.2">
           <mtext id="alg1.l33.m1.1.1.2.cmml" xref="alg1.l33.m1.1.1.2">
            new_instr
           </mtext>
          </ci>
          <ci id="alg1.l33.m1.1.1.3a.cmml" xref="alg1.l33.m1.1.1.3">
           <mtext id="alg1.l33.m1.1.1.3.cmml" xref="alg1.l33.m1.1.1.3">
            instruction_list
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l33.m1.1c">
         \text{new\_instr}\to\text{instruction\_list}
        </annotation>
       </semantics>
      </math>
      ;
     </div>
     <div class="ltx_listingline" id="alg1.l34">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l34.2.1.1" style="font-size:80%;">
        34:
       </span>
      </span>
      <span class="ltx_text" id="alg1.l34.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l34.1.m1.1">
        <semantics id="alg1.l34.1.m1.1a">
         <mo id="alg1.l34.1.m1.1.1" xref="alg1.l34.1.m1.1.1.cmml">
          ‚ñ∑
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l34.1.m1.1b">
          <ci id="alg1.l34.1.m1.1.1.cmml" xref="alg1.l34.1.m1.1.1">
           ‚ñ∑
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l34.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       next iteration
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l35">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l35.1.1.1" style="font-size:80%;">
        35:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l35.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l35.3">
       for
      </span>
     </div>
    </div>
   </figure>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Batch Query Sampling
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     To ensure our prompt Modifier generalizes across a wide range of user prompts, we adopt a strategy akin to batch gradient descent. In each iteration, we uniformly sample a batch of queries
     <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
      <semantics id="S3.SS2.p1.1.m1.1a">
       <mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
        Q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
        <ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
         ùëÑ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">
        Q
       </annotation>
      </semantics>
     </math>
     from the pool of simple prompts. The objective is to minimize the expected loss across all possible prompts, aiming for a Modifier that performs well on the average case rather than overfitting to specific instances.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.6">
     Mathematically, we express this as optimizing the expected loss
     <math alttext="\mathbb{E}_{q\sim P}[L(f_{\theta}(q),y)]" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.3">
      <semantics id="S3.SS2.p2.1.m1.3a">
       <mrow id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml">
        <msub id="S3.SS2.p2.1.m1.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.cmml">
         <mi id="S3.SS2.p2.1.m1.3.3.3.2" xref="S3.SS2.p2.1.m1.3.3.3.2.cmml">
          ùîº
         </mi>
         <mrow id="S3.SS2.p2.1.m1.3.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.3.cmml">
          <mi id="S3.SS2.p2.1.m1.3.3.3.3.2" xref="S3.SS2.p2.1.m1.3.3.3.3.2.cmml">
           q
          </mi>
          <mo id="S3.SS2.p2.1.m1.3.3.3.3.1" xref="S3.SS2.p2.1.m1.3.3.3.3.1.cmml">
           ‚àº
          </mo>
          <mi id="S3.SS2.p2.1.m1.3.3.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.3.3.cmml">
           P
          </mi>
         </mrow>
        </msub>
        <mo id="S3.SS2.p2.1.m1.3.3.2" lspace="0em" rspace="0em" xref="S3.SS2.p2.1.m1.3.3.2.cmml">
         ‚Äã
        </mo>
        <mrow id="S3.SS2.p2.1.m1.3.3.1.1" xref="S3.SS2.p2.1.m1.3.3.1.2.cmml">
         <mo id="S3.SS2.p2.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.2.1.cmml">
          [
         </mo>
         <mrow id="S3.SS2.p2.1.m1.3.3.1.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.cmml">
          <mi id="S3.SS2.p2.1.m1.3.3.1.1.1.3" xref="S3.SS2.p2.1.m1.3.3.1.1.1.3.cmml">
           L
          </mi>
          <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p2.1.m1.3.3.1.1.1.2.cmml">
           ‚Äã
          </mo>
          <mrow id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.2.cmml">
           <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.2.cmml">
            (
           </mo>
           <mrow id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">
            <msub id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.cmml">
             <mi id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.2.cmml">
              f
             </mi>
             <mi id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.3.cmml">
              Œ∏
             </mi>
            </msub>
            <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.1.cmml">
             ‚Äã
            </mo>
            <mrow id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">
             <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">
              (
             </mo>
             <mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">
              q
             </mi>
             <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.2.cmml">
            ,
           </mo>
           <mi id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">
            y
           </mi>
           <mo id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.2.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S3.SS2.p2.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS2.p2.1.m1.3.3.1.2.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b">
        <apply id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3">
         <times id="S3.SS2.p2.1.m1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2">
         </times>
         <apply id="S3.SS2.p2.1.m1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3">
          <csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.3.1.cmml" xref="S3.SS2.p2.1.m1.3.3.3">
           subscript
          </csymbol>
          <ci id="S3.SS2.p2.1.m1.3.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.3.2">
           ùîº
          </ci>
          <apply id="S3.SS2.p2.1.m1.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3">
           <csymbol cd="latexml" id="S3.SS2.p2.1.m1.3.3.3.3.1.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3.1">
            similar-to
           </csymbol>
           <ci id="S3.SS2.p2.1.m1.3.3.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3.2">
            ùëû
           </ci>
           <ci id="S3.SS2.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3.3.3">
            ùëÉ
           </ci>
          </apply>
         </apply>
         <apply id="S3.SS2.p2.1.m1.3.3.1.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1">
          <csymbol cd="latexml" id="S3.SS2.p2.1.m1.3.3.1.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.2">
           delimited-[]
          </csymbol>
          <apply id="S3.SS2.p2.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1">
           <times id="S3.SS2.p2.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.2">
           </times>
           <ci id="S3.SS2.p2.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.3">
            ùêø
           </ci>
           <interval closure="open" id="S3.SS2.p2.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1">
            <apply id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1">
             <times id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.1">
             </times>
             <apply id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2">
               subscript
              </csymbol>
              <ci id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.2">
               ùëì
              </ci>
              <ci id="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.1.1.2.3">
               ùúÉ
              </ci>
             </apply>
             <ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">
              ùëû
             </ci>
            </apply>
            <ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">
             ùë¶
            </ci>
           </interval>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">
        \mathbb{E}_{q\sim P}[L(f_{\theta}(q),y)]
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1">
      <semantics id="S3.SS2.p2.2.m2.1a">
       <mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">
        Œ∏
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b">
        <ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">
         ùúÉ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     denotes the Modifier‚Äôs parameters,
     <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1">
      <semantics id="S3.SS2.p2.3.m3.1a">
       <mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">
        L
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b">
        <ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">
         ùêø
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">
        L
       </annotation>
      </semantics>
     </math>
     the loss function,
     <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1">
      <semantics id="S3.SS2.p2.4.m4.1a">
       <msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">
        <mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">
         f
        </mi>
        <mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">
         Œ∏
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b">
        <apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">
          ùëì
         </ci>
         <ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">
          ùúÉ
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">
        f_{\theta}
       </annotation>
      </semantics>
     </math>
     the Modifier function,
     <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1">
      <semantics id="S3.SS2.p2.5.m5.1a">
       <mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">
        q
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b">
        <ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">
         ùëû
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">
        q
       </annotation>
      </semantics>
     </math>
     a sampled query, and
     <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1">
      <semantics id="S3.SS2.p2.6.m6.1a">
       <mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b">
        <ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">
         ùë¶
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">
        y
       </annotation>
      </semantics>
     </math>
     the target output.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.1">
     By updating
     <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1">
      <semantics id="S3.SS2.p3.1.m1.1a">
       <mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">
        Œ∏
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b">
        <ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">
         ùúÉ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     based on the empirical loss from the batch, we regularize the training process to prevent overfitting, ensuring the Modifier‚Äôs broad applicability.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Selector
   </h3>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.1">
     In our methodology, the Selector component plays a critical role in maintaining a constant length of the instruction list, a challenge akin to the well-known Multi-Armed Bandit Problem. The reward metric in our context is the batch loss associated with each instruction in the tracks, providing a direct measure of instruction efficacy.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.1">
     Our initial intention was to utilize the Upper Confidence Bound (UCB) algorithm, renowned for its balance between exploration of new strategies and exploitation of known rewarding actions. To validate this choice, we conducted comparative analyses with other prevalent selection strategies, including a greedy approach that consistently favors the instruction with the lowest batch loss, and an epsilon-greedy method, which introduces a probability of selecting a suboptimal instruction to allow for exploration beyond the immediately rewarding options.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Results
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    For witnessing the increase of quality of image generated using the optimized prompt of Generator, we set the baseline by using the normal instruction for prompt refinement and textimage generation which is "This is the original prompt that you need to carefully refine, Prompt or subject to refine :{query}", the lexica prompt directed generated image and our optimised Generator instruction"Integrate exercises that challenge writers to distill their descriptions to the most essential elements while effectively evoking the desired emotions, reinforcing the lesson on brevity and precision in storytelling. Emphasize the use of impactful language and imagery to succinctly capture the essence of a scene and immerse the reader in a cohesive narrative that evokes awe, wonder, and exploration, ultimately igniting feelings of exhilaration and reverence for the boundless beauty and possibilities within the depicted setting,Prompt or subject to refine is : {query}"
   </p>
  </div>
  <figure class="ltx_figure" id="S4.F2">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_3">
     <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F2.sf1.g1" src="/html/2406.08713/assets/images/image_0_base.png" width="598"/>
      <figcaption class="ltx_caption">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S4.F2.sf1.2.1.1" style="font-size:90%;">
         (a)
        </span>
       </span>
       <span class="ltx_text" id="S4.F2.sf1.3.2" style="font-size:90%;">
        Baseline image generated using GPT-3.5‚Äôs initial instruction
       </span>
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_cell ltx_flex_size_3">
     <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf2">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F2.sf2.g1" src="/html/2406.08713/assets/images/image_0_lexica.png" width="598"/>
      <figcaption class="ltx_caption">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S4.F2.sf2.2.1.1" style="font-size:90%;">
         (b)
        </span>
       </span>
       <span class="ltx_text" id="S4.F2.sf2.3.2" style="font-size:90%;">
        Image generated on Lexica‚Äôs prompt
       </span>
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_cell ltx_flex_size_3">
     <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf3">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S4.F2.sf3.g1" src="/html/2406.08713/assets/images/image_0_ucb_optimzed.png" width="598"/>
      <figcaption class="ltx_caption">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S4.F2.sf3.2.1.1" style="font-size:90%;">
         (c)
        </span>
       </span>
       <span class="ltx_text" id="S4.F2.sf3.3.2" style="font-size:90%;">
        Optimized image using UCB selection method
       </span>
      </figcaption>
     </figure>
    </div>
   </div>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">
      Figure 2
     </span>
     :
    </span>
    <span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">
     Comparison of images generated from the same input "cactus" using different methods.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S4.p2">
   <p class="ltx_p" id="S4.p2.1">
    The results of experiments are shown below in Table 1.
   </p>
  </div>
  <figure class="ltx_table" id="S4.T1">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">
      Table 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">
     Results of experiments in different selection method and batch size.
    </span>
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="S4.T1.4.1.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.4.1.1.1">
       <span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.1.1">
        Batch size
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.4.1.1.2">
       <span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.2.1">
        Selection Method
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.4.1.1.3">
       <span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.3.1">
        initial Score
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.1.1.4">
       <span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.4.1">
        Last Iteration Score
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S4.T1.4.2.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.2.1.1">
       1
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.2.1.2">
       UCB
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.2.1.3">
       25.54
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.4">
       <span class="ltx_text ltx_font_bold" id="S4.T1.4.2.1.4.1">
        28.78
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T1.4.3.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.3.2.1">
       3
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.3.2.2">
       UCB
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.3.2.3">
       28.3
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.4">
       27.69
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T1.4.4.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.4.3.1">
       5
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.3.2">
       UCB
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.3.3">
       27.61
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.4">
       27.88
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T1.4.5.4">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.5.4.1">
       3
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.4.2">
       greedy
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.5.4.3">
       27.62
      </td>
      <td class="ltx_td ltx_align_center" id="S4.T1.4.5.4.4">
       28.02
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T1.4.6.5">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T1.4.6.5.1">
       3
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.6.5.2">
       epsilon_greedy
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.4.6.5.3">
       27.98
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.6.5.4">
       28.72
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <figure class="ltx_table" id="S4.T2">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">
      Table 2
     </span>
     :
    </span>
    <span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">
     Comparison with GPT3.5 and lexica Baseline
    </span>
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="S4.T2.4.1.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.1">
       <span class="ltx_text ltx_font_bold" id="S4.T2.4.1.1.1.1">
        Method
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.2">
       <span class="ltx_text ltx_font_bold" id="S4.T2.4.1.1.2.1">
        Score
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S4.T2.4.2.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.2.1.1">
       GPT3.5 Baseline
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.4.2.1.2">
       26.34
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.4.3.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.3.2.1">
       Lexica Baseline
      </th>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.4.3.2.2">
       26.14
      </td>
     </tr>
     <tr class="ltx_tr" id="S4.T2.4.4.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.1">
       Our method
      </th>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.2">
       <span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.2.1">
        26.72
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <div class="ltx_para" id="S4.p3">
   <p class="ltx_p" id="S4.p3.1">
    able 1 reveals outcomes from testing different batch sizes and selection methods on image generation across 10 iterations. Using the Upper Confidence Bounds (UCB) method with a batch size of 1, scores improved from 25.54 to 28.78. However, a batch size of 3 with UCB saw a slight decrease from 28.3 to 27.69, while increasing to batch size 5 led to a small increase from 27.61 to 27.88. The greedy method with batch size 3 raised the score from 27.62 to 28.02, and the epsilon-greedy method increased it more significantly from 27.98 to 28.72.
   </p>
  </div>
  <div class="ltx_para" id="S4.p4">
   <p class="ltx_p" id="S4.p4.1">
    These results indicate that smaller batch sizes with UCB showed the most significant improvement, whereas larger sizes under the same method slightly decreased or marginally improved. Conversely, both greedy and epsilon-greedy methods with a batch size of 3 enhanced scores, demonstrating how different strategies impact image generation efficacy.
   </p>
  </div>
  <div class="ltx_para" id="S4.p5">
   <p class="ltx_p" id="S4.p5.1">
    Additionally, baseline comparisons
    <a class="ltx_ref" href="#S4.T2" title="Table 2 ‚Ä£ 4 Results ‚Ä£ Batch-Instructed Gradient for Prompt Evolution: Systematic Prompt Optimization for Enhanced Text-to-Image Synthesis">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    were conducted to evaluate our method against the GPT-3.5 baseline, where GPT-3.5 served as a prompt modifier, and Lexica, which acted as a human professional baseline by sourcing corresponding prompts based on queries. For fairness, 10 simple prompts were sampled, and average scores were extracted for each system. Results indicated that our method outperformed each baseline approach.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Meaningful suggestion given by Gradient calculator
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     The following are example outputs of the Gradient calculator, showcasing the low score and high score prompt group, followed by the inferred insights and proposed improvements for the instruction,guiding it to generate the structure and content approach high score prompts :
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <ul class="ltx_itemize" id="S4.I1">
     <li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I1.i1.p1">
       <p class="ltx_p" id="S4.I1.i1.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">
         Low Score Object 0:
        </span>
        Aquarium with sharks
       </p>
       <ul class="ltx_itemize" id="S4.I1.i1.I1">
        <li class="ltx_item" id="S4.I1.i1.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i1.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i1.I1.i1.p1">
          <p class="ltx_p" id="S4.I1.i1.I1.i1.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i1.I1.i1.p1.1.1">
            Low Score Generated Prompt 0:
           </span>
           A captivating aquarium display featuring powerful sharks, offering a glimpse into the mysterious world of these majestic creatures in a controlled and mesmerizing environment.
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S4.I1.i1.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i1.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i1.I1.i2.p1">
          <p class="ltx_p" id="S4.I1.i1.I1.i2.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i1.I1.i2.p1.1.1">
            Score:
           </span>
           27.587890625
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I1.i2.p1">
       <p class="ltx_p" id="S4.I1.i2.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">
         Low Score Object 1:
        </span>
        Farm with windmill
       </p>
       <ul class="ltx_itemize" id="S4.I1.i2.I1">
        <li class="ltx_item" id="S4.I1.i2.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i2.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i2.I1.i1.p1">
          <p class="ltx_p" id="S4.I1.i2.I1.i1.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i2.I1.i1.p1.1.1">
            Low Score Generated Prompt 1:
           </span>
           Enhanced Prompt: Immerse yourself in the idyllic charm of a countryside farm, where a majestic windmill towers over lush fields of swaying wheat and vibrant sunflowers‚Ä¶
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S4.I1.i2.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i2.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i2.I1.i2.p1">
          <p class="ltx_p" id="S4.I1.i2.I1.i2.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i2.I1.i2.p1.1.1">
            Score:
           </span>
           26.3671875
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I1.i3.p1">
       <p class="ltx_p" id="S4.I1.i3.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">
         High Score Object 0:
        </span>
        Aquarium with sharks
       </p>
       <ul class="ltx_itemize" id="S4.I1.i3.I1">
        <li class="ltx_item" id="S4.I1.i3.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i3.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i3.I1.i1.p1">
          <p class="ltx_p" id="S4.I1.i3.I1.i1.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i3.I1.i1.p1.1.1">
            High Score Prompt 0:
           </span>
           An aquarium exhibit featuring majestic sharks gliding effortlessly through the water, their sleek bodies cutting through the vibrant underwater environment‚Ä¶
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S4.I1.i3.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i3.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i3.I1.i2.p1">
          <p class="ltx_p" id="S4.I1.i3.I1.i2.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i3.I1.i2.p1.1.1">
            Score:
           </span>
           28.5400390625
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I1.i4.p1">
       <p class="ltx_p" id="S4.I1.i4.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">
         High Score Object 1:
        </span>
        Farm with windmill
       </p>
       <ul class="ltx_itemize" id="S4.I1.i4.I1">
        <li class="ltx_item" id="S4.I1.i4.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i4.I1.i1.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i4.I1.i1.p1">
          <p class="ltx_p" id="S4.I1.i4.I1.i1.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i4.I1.i1.p1.1.1">
            High Score Prompt 1:
           </span>
           Refined Prompt: A serene farm landscape featuring a classic windmill set against a backdrop of rolling fields, depicting the timeless charm of rural life and agricultural tradition.
          </p>
         </div>
        </li>
        <li class="ltx_item" id="S4.I1.i4.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="S4.I1.i4.I1.i2.1.1.1">
           ‚Äì
          </span>
         </span>
         <div class="ltx_para" id="S4.I1.i4.I1.i2.p1">
          <p class="ltx_p" id="S4.I1.i4.I1.i2.p1.1">
           <span class="ltx_text ltx_font_bold" id="S4.I1.i4.I1.i2.p1.1.1">
            Score:
           </span>
           27.2705078125
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
    </ul>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SSx1">
   <h3 class="ltx_title ltx_title_subsection">
    Inferences and Improvements
   </h3>
   <div class="ltx_para" id="S4.SSx1.p1">
    <ul class="ltx_itemize" id="S4.I2">
     <li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I2.i1.p1">
       <p class="ltx_p" id="S4.I2.i1.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">
         Inference 0:
        </span>
        The low score prompts lack depth and fail to evoke a sense of intrigue or engagement, missing opportunities to add layers of complexity or emotion to the scenes described.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I2.i2.p1">
       <p class="ltx_p" id="S4.I2.i2.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">
         Inference 1:
        </span>
        The low score prompts tend to be overly elaborate and excessively detailed, which can overwhelm the reader and detract from the core message of the prompt.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I2.i3.p1">
       <p class="ltx_p" id="S4.I2.i3.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">
         Improvement 0:
        </span>
        Emphasize the importance of creativity and originality in prompt generation, encouraging writers to think outside the box and incorporate unexpected elements to pique the reader‚Äôs interest.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       ‚Ä¢
      </span>
      <div class="ltx_para" id="S4.I2.i4.p1">
       <p class="ltx_p" id="S4.I2.i4.p1.1">
        <span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.1.1">
         Improvement 1:
        </span>
        Encourage writers to strike a balance between detailed descriptions and concise communication in their prompts, ensuring that every detail adds value to the overall visualization without overwhelming the reader.
       </p>
      </div>
     </li>
    </ul>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Discussion
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    The analysis presents a clear distinction in image quality when comparing outputs generated from initial and optimized instructions. The images crafted with our optimization methods demonstrably align more closely with human aesthetic preferences. This enhancement is reflected in our results table, where scores for images from the final iteration surpass those from the initial round, with the singular exception of the batch size three UCB experiment. The deviation in this instance is likely attributed to the exploratory component of the UCB algorithm, necessitating additional iterations to attain conclusive evidence of convergence and ultimate performance efficacy.
   </p>
  </div>
  <div class="ltx_para" id="S5.p2">
   <p class="ltx_p" id="S5.p2.1">
    Adjustments to the batch size have revealed a correlation with the rate of convergence towards optimal instruction refinement, offering broader improvements across batches of prompts. However, this comes at the increased expense of input and output tokens for each iteration, indicating a trade-off between the rate of improvement and computational resource allocation.
   </p>
  </div>
  <div class="ltx_para" id="S5.p3">
   <p class="ltx_p" id="S5.p3.1">
    Further, the study indicates that image quality is contingent upon the chosen diffusion model and the depicted object. For example, the SDX_turbo model employed within our experiments demonstrates the capacity to generate visually appealing images with high scores, even from simpler, naive prompts. This observation is consistent across representations of specific subjects such as ‚Äôflaming Phoenix‚Äô and ‚Äôluxury yacht‚Äô, where complex, detailed prompts do not necessarily yield a commensurate increase in image quality. These variations suggest that the perceived improvements in image scores from the last iteration of experiments may be less pronounced under certain conditions.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Limitation
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    The restrictions of this work are classified into three categories: time limits, computational resource limitations, and the unpredictability inherent in diffusion models.
   </p>
  </div>
  <div class="ltx_para" id="S6.p2">
   <p class="ltx_p" id="S6.p2.1">
    The project‚Äôs short plan prevented thorough experimentation with a variety of concepts. As a result, engaging with sophisticated models such as Llama or GPT-4 was not practical. Furthermore, model training was limited to 10 iterations at most, which is a significant constraint. Given the significant time and processing power necessary to fully train such models, the limited number of iterations most certainly hampered the models‚Äô capacity to achieve optimal convergence, as evidenced by the minor improvements seen in our studies.
   </p>
  </div>
  <div class="ltx_para" id="S6.p3">
   <p class="ltx_p" id="S6.p3.1">
    Second, the exploratory scope of diffusion models was restricted. Diffusion models‚Äô performance can vary greatly‚Äîsome models may create superior pictures with simple instructions, while others may require complex, comprehensive inputs to obtain equivalent results. As a result, a more in-depth examination into alternative diffusion models may have provided a more complete grasp of their possibilities.
   </p>
  </div>
  <div class="ltx_para" id="S6.p4">
   <p class="ltx_p" id="S6.p4.1">
    For future goals, if greater computer resources become available, the number of training iterations should be significantly increased. Furthermore, doing a comparison analysis across a range of diffusion models is likely to broaden and deepen the findings.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S7">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    7
   </span>
   Code
  </h2>
  <div class="ltx_para" id="S7.p1">
   <p class="ltx_p" id="S7.p1.1">
    The github link is given here, please click on it to reach our repository :
    <a class="ltx_ref ltx_href" href="https://github.com/slark-prime/MAAI_Optimizer" target="_blank" title="">
     Group20-MAAI-Code
    </a>
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Example Instructions
  </h2>
  <figure class="ltx_table" id="A1.T3">
   <figcaption class="ltx_caption" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 3:
    </span>
    Examples of Gradient Calculator Input and Output
   </figcaption>
   <table class="ltx_tabular" id="A1.T3.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A1.T3.4.1.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A1.T3.4.1.1.1">
       <span class="ltx_text ltx_font_bold" id="A1.T3.4.1.1.1.1" style="font-size:90%;">
        Prompt Design
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A1.T3.4.2.1">
      <td class="ltx_td ltx_align_left ltx_border_t" colspan="2" id="A1.T3.4.2.1.1">
       <span class="ltx_text ltx_font_bold" id="A1.T3.4.2.1.1.1" style="font-size:90%;">
        Demonstration
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A1.T3.4.3.2">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.4.3.2.1">
       <span class="ltx_text" id="A1.T3.4.3.2.1.1" style="font-size:90%;">
        Gradient Calculator Input
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T3.4.3.2.2">
       <span class="ltx_inline-block ltx_align_top" id="A1.T3.4.3.2.2.1">
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.1" style="width:341.4pt;">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.1.1" style="font-size:90%;">
          Analyze the following low score and high score batch, each prompt with corresponding scores. And infer what‚Äôs wrong with the instruction generating low score batch prompt to suggest the improvement of the instruction:For your answer use the format:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.2">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.2.1" style="font-size:90%;">
          Inference 1: your inference_1
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.3">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.3.1" style="font-size:90%;">
          Inference 2: your inference_2
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.4">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.4.1" style="font-size:90%;">
          Inference n: your inference_n‚Ä¶
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.5">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.5.1" style="font-size:90%;">
          Improvement 1: you suggested improvement correspond to inference 1
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.6">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.6.1" style="font-size:90%;">
          Improvement 2: you suggested improvement correspond to Inference 2
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.7">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.7.1" style="font-size:90%;">
          Improvement n: you suggested improvement correspond to inference n‚Ä¶
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.8">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.8.1" style="font-size:90%;">
          This is the generator instruction:{instruction} and first corresponding generated low score prompts group:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.9">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.9.1" style="font-size:90%;">
          low_score_object{i}:{obj_i},
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.10">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.10.1" style="font-size:90%;">
          low_score_generated_prompt:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.11">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.11.1" style="font-size:90%;">
          {low_score_prompt_i},score:{low_score_i}
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.12">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.12.1" style="font-size:90%;">
          below is high score prompts group:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.13">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.13.1" style="font-size:90%;">
          high_score_object{i}:{obj_i},
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.14">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.14.1" style="font-size:90%;">
          high_score_prompt:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.15">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.15.1" style="font-size:90%;">
          {high_score_prompt_i},score:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.3.2.2.1.16">
         <span class="ltx_text" id="A1.T3.4.3.2.2.1.16.1" style="font-size:90%;">
          {high_score_i}"
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A1.T3.4.4.3">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b ltx_border_r ltx_border_t" id="A1.T3.4.4.3.1">
       <span class="ltx_text" id="A1.T3.4.4.3.1.1" style="font-size:90%;">
        Gradient Calculator Output
       </span>
      </td>
      <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_b ltx_border_t" id="A1.T3.4.4.3.2">
       <span class="ltx_inline-block ltx_align_top" id="A1.T3.4.4.3.2.1">
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.1" style="width:341.4pt;">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.1.1" style="font-size:90%;">
          analyze_and_propose: Summary of Reasons for Scores:
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.2">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.2.1" style="font-size:90%;">
          Inference 1: The low score prompts may have focused too much on describing the hot air balloon and the view, while not incorporating the feeling of exhilaration and awe effectively.
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.3">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.3.1" style="font-size:90%;">
          Inference 2: The low score prompts may have lacked creativity in conveying the emotions of exhilaration and awe through the scene described.
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.4">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.4.1" style="font-size:90%;">
          Improvement 1: Encourage writers to not only describe the setting but also focus on capturing the emotions of exhilaration and awe experienced by the passengers in the hot air balloon.
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.5">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.5.1" style="font-size:90%;">
          Improvement 2: Provide examples or suggestions on how to infuse more creativity and emotional depth into the description of the panoramic view, making it more evocative of exhilaration and awe.
         </span>
        </span>
        <span class="ltx_p" id="A1.T3.4.4.3.2.1.6">
         <span class="ltx_text" id="A1.T3.4.4.3.2.1.6.1" style="font-size:90%;">
          Improvement 3: Include guidance on using vibrant language and sensory details to intensify the reader‚Äôs experience of exhilaration and awe in the scene described.
         </span>
        </span>
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hao et¬†al. [2024]
    </span>
    <span class="ltx_bibblock">
     Yaru Hao, Zewen Chi, Li¬†Dong, and Furu Wei.
    </span>
    <span class="ltx_bibblock">
     Optimizing prompts for text-to-image generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 36, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kirstain et¬†al. [2024]
    </span>
    <span class="ltx_bibblock">
     Yuval Kirstain, Adam Polyak, Uriel Singer, Shahbuland Matiana, Joe Penna, and Omer Levy.
    </span>
    <span class="ltx_bibblock">
     Pick-a-pic: An open dataset of user preferences for text-to-image generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 36, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kuleshov and Precup [2014]
    </span>
    <span class="ltx_bibblock">
     Volodymyr Kuleshov and Doina Precup.
    </span>
    <span class="ltx_bibblock">
     Algorithms for multi-armed bandit problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      arXiv preprint arXiv:1402.6028
     </em>
     , 2014.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ma et¬†al. [2024]
    </span>
    <span class="ltx_bibblock">
     Ruotian Ma, Xiaolei Wang, Xin Zhou, Jian Li, Nan Du, Tao Gui, Qi¬†Zhang, and Xuanjing Huang.
    </span>
    <span class="ltx_bibblock">
     Are large language models good prompt optimizers?, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nichol et¬†al. [2021]
    </span>
    <span class="ltx_bibblock">
     Alex Nichol, Prafulla Dhariwal, Aditya Ramesh, Pranav Shyam, Pamela Mishkin, Bob McGrew, Ilya Sutskever, and Mark Chen.
    </span>
    <span class="ltx_bibblock">
     Glide: Towards photorealistic image generation and editing with text-guided diffusion models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      arXiv preprint arXiv:2112.10741
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Podell et¬†al. [2023]
    </span>
    <span class="ltx_bibblock">
     Dustin Podell, Zion English, Kyle Lacey, Andreas Blattmann, Tim Dockhorn, Jonas M√ºller, Joe Penna, and Robin Rombach.
    </span>
    <span class="ltx_bibblock">
     Sdxl: Improving latent diffusion models for high-resolution image synthesis, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pryzant et¬†al. [2023]
    </span>
    <span class="ltx_bibblock">
     Reid Pryzant, Dan Iter, Jerry Li, Yin¬†Tat Lee, Chenguang Zhu, and Michael Zeng.
    </span>
    <span class="ltx_bibblock">
     Automatic prompt optimization with "gradient descent" and beam search, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ramesh et¬†al. [2021]
    </span>
    <span class="ltx_bibblock">
     Aditya Ramesh, Mikhail Pavlov, Gabriel Goh, Scott Gray, Chelsea Voss, Alec Radford, Mark Chen, and Ilya Sutskever.
    </span>
    <span class="ltx_bibblock">
     Zero-shot text-to-image generation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      International conference on machine learning
     </em>
     , pages 8821‚Äì8831. Pmlr, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ramesh et¬†al. [2022]
    </span>
    <span class="ltx_bibblock">
     Aditya Ramesh, Prafulla Dhariwal, Alex Nichol, Casey Chu, and Mark Chen.
    </span>
    <span class="ltx_bibblock">
     Hierarchical text-conditional image generation with clip latents.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      arXiv preprint arXiv:2204.06125
     </em>
     , 1(2):3, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et¬†al. [2023a]
    </span>
    <span class="ltx_bibblock">
     Xiaoshi Wu, Yiming Hao, Keqiang Sun, Yixiong Chen, Feng Zhu, Rui Zhao, and Hongsheng Li.
    </span>
    <span class="ltx_bibblock">
     Human preference score v2: A solid benchmark for evaluating human preferences of text-to-image synthesis, 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et¬†al. [2023b]
    </span>
    <span class="ltx_bibblock">
     Xiaoshi Wu, Keqiang Sun, Feng Zhu, Rui Zhao, and Hongsheng Li.
    </span>
    <span class="ltx_bibblock">
     Human preference score: Better aligning text-to-image models with human preference, 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xu et¬†al. [2024]
    </span>
    <span class="ltx_bibblock">
     Jiazheng Xu, Xiao Liu, Yuchen Wu, Yuxuan Tong, Qinkai Li, Ming Ding, Jie Tang, and Yuxiao Dong.
    </span>
    <span class="ltx_bibblock">
     Imagereward: Learning and evaluating human preferences for text-to-image generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 36, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et¬†al. [2024]
    </span>
    <span class="ltx_bibblock">
     Chengrun Yang, Xuezhi Wang, Yifeng Lu, Hanxiao Liu, Quoc¬†V. Le, Denny Zhou, and Xinyun Chen.
    </span>
    <span class="ltx_bibblock">
     Large language models as optimizers, 2024.
    </span>
   </li>
  </ul>
 </section>
</article>
